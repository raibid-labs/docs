<!DOCTYPE html>
<html lang="en" dir="ltr"><head><title>obi-comprehensive-research</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;family=IBM Plex Mono:wght@400;600&amp;display=swap"/><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin="anonymous"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="og:site_name" content="Raibid Labs Documentation"/><meta property="og:title" content="obi-comprehensive-research"/><meta property="og:type" content="website"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="obi-comprehensive-research"/><meta name="twitter:description" content="OpenTelemetry Backend Initiative (OBI) - Comprehensive Research Report Research Date: November 6, 2025 Status: Alpha Release (November 3, 2025) Table of Contents Executive Summary What is OBI? First Release Details Architecture &amp; Technical Design Integration with Grafana Stack Deployment Strateg..."/><meta property="og:description" content="OpenTelemetry Backend Initiative (OBI) - Comprehensive Research Report Research Date: November 6, 2025 Status: Alpha Release (November 3, 2025) Table of Contents Executive Summary What is OBI? First Release Details Architecture &amp; Technical Design Integration with Grafana Stack Deployment Strateg..."/><meta property="og:image:alt" content="OpenTelemetry Backend Initiative (OBI) - Comprehensive Research Report Research Date: November 6, 2025 Status: Alpha Release (November 3, 2025) Table of Contents Executive Summary What is OBI? First Release Details Architecture &amp; Technical Design Integration with Grafana Stack Deployment Strateg..."/><meta property="twitter:domain" content="raibid-labs.github.io/docs"/><meta property="og:url" content="https://raibid-labs.github.io/docs/projects/mop/docs/research/obi-comprehensive-research"/><meta property="twitter:url" content="https://raibid-labs.github.io/docs/projects/mop/docs/research/obi-comprehensive-research"/><link rel="icon" href="../../../../static/icon.png"/><meta name="description" content="OpenTelemetry Backend Initiative (OBI) - Comprehensive Research Report Research Date: November 6, 2025 Status: Alpha Release (November 3, 2025) Table of Contents Executive Summary What is OBI? First Release Details Architecture &amp; Technical Design Integration with Grafana Stack Deployment Strateg..."/><meta name="generator" content="Quartz"/><link href="../../../../index.css" rel="stylesheet" type="text/css" spa-preserve/><style>.expand-button {
  position: absolute;
  display: flex;
  float: right;
  padding: 0.4rem;
  margin: 0.3rem;
  right: 0;
  color: var(--gray);
  border-color: var(--dark);
  background-color: var(--light);
  border: 1px solid;
  border-radius: 5px;
  opacity: 0;
  transition: 0.2s;
}
.expand-button > svg {
  fill: var(--light);
  filter: contrast(0.3);
}
.expand-button:hover {
  cursor: pointer;
  border-color: var(--secondary);
}
.expand-button:focus {
  outline: 0;
}

pre:hover > .expand-button {
  opacity: 1;
  transition: 0.2s;
}

#mermaid-container {
  position: fixed;
  contain: layout;
  z-index: 999;
  left: 0;
  top: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  display: none;
  backdrop-filter: blur(4px);
  background: rgba(0, 0, 0, 0.5);
}
#mermaid-container.active {
  display: inline-block;
}
#mermaid-container > #mermaid-space {
  border: 1px solid var(--lightgray);
  background-color: var(--light);
  border-radius: 5px;
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  height: 80vh;
  width: 80vw;
  overflow: hidden;
}
#mermaid-container > #mermaid-space > .mermaid-content {
  padding: 2rem;
  position: relative;
  transform-origin: 0 0;
  transition: transform 0.1s ease;
  overflow: visible;
  min-height: 200px;
  min-width: 200px;
}
#mermaid-container > #mermaid-space > .mermaid-content pre {
  margin: 0;
  border: none;
}
#mermaid-container > #mermaid-space > .mermaid-content svg {
  max-width: none;
  height: auto;
}
#mermaid-container > #mermaid-space > .mermaid-controls {
  position: absolute;
  bottom: 20px;
  right: 20px;
  display: flex;
  gap: 8px;
  padding: 8px;
  background: var(--light);
  border: 1px solid var(--lightgray);
  border-radius: 6px;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  z-index: 2;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  padding: 0;
  border: 1px solid var(--lightgray);
  background: var(--light);
  color: var(--dark);
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  font-family: var(--bodyFont);
  transition: all 0.2s ease;
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:hover {
  background: var(--lightgray);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:active {
  transform: translateY(1px);
}
#mermaid-container > #mermaid-space > .mermaid-controls .mermaid-control-button:nth-child(2) {
  width: auto;
  padding: 0 12px;
  font-size: 14px;
}
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VSb290IjoiL2hvbWUvcnVubmVyL3dvcmsvZG9jcy9kb2NzL3F1YXJ0ei9jb21wb25lbnRzL3N0eWxlcyIsInNvdXJjZXMiOlsibWVybWFpZC5pbmxpbmUuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTs7QUFHRjtFQUNFO0VBQ0E7O0FBR0Y7RUFDRTs7O0FBS0Y7RUFDRTtFQUNBOzs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTs7QUFHRjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBOztBQUdGO0VBQ0U7RUFDQTs7QUFJSjtFQUNFO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7O0FBRUE7RUFDRTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBO0VBQ0E7RUFDQTtFQUNBOztBQUVBO0VBQ0U7O0FBR0Y7RUFDRTs7QUFJRjtFQUNFO0VBQ0E7RUFDQSIsInNvdXJjZXNDb250ZW50IjpbIi5leHBhbmQtYnV0dG9uIHtcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBkaXNwbGF5OiBmbGV4O1xuICBmbG9hdDogcmlnaHQ7XG4gIHBhZGRpbmc6IDAuNHJlbTtcbiAgbWFyZ2luOiAwLjNyZW07XG4gIHJpZ2h0OiAwOyAvLyBOT1RFOiByaWdodCB3aWxsIGJlIHNldCBpbiBtZXJtYWlkLmlubGluZS50c1xuICBjb2xvcjogdmFyKC0tZ3JheSk7XG4gIGJvcmRlci1jb2xvcjogdmFyKC0tZGFyayk7XG4gIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWxpZ2h0KTtcbiAgYm9yZGVyOiAxcHggc29saWQ7XG4gIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgb3BhY2l0eTogMDtcbiAgdHJhbnNpdGlvbjogMC4ycztcblxuICAmID4gc3ZnIHtcbiAgICBmaWxsOiB2YXIoLS1saWdodCk7XG4gICAgZmlsdGVyOiBjb250cmFzdCgwLjMpO1xuICB9XG5cbiAgJjpob3ZlciB7XG4gICAgY3Vyc29yOiBwb2ludGVyO1xuICAgIGJvcmRlci1jb2xvcjogdmFyKC0tc2Vjb25kYXJ5KTtcbiAgfVxuXG4gICY6Zm9jdXMge1xuICAgIG91dGxpbmU6IDA7XG4gIH1cbn1cblxucHJlIHtcbiAgJjpob3ZlciA+IC5leHBhbmQtYnV0dG9uIHtcbiAgICBvcGFjaXR5OiAxO1xuICAgIHRyYW5zaXRpb246IDAuMnM7XG4gIH1cbn1cblxuI21lcm1haWQtY29udGFpbmVyIHtcbiAgcG9zaXRpb246IGZpeGVkO1xuICBjb250YWluOiBsYXlvdXQ7XG4gIHotaW5kZXg6IDk5OTtcbiAgbGVmdDogMDtcbiAgdG9wOiAwO1xuICB3aWR0aDogMTAwdnc7XG4gIGhlaWdodDogMTAwdmg7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIGRpc3BsYXk6IG5vbmU7XG4gIGJhY2tkcm9wLWZpbHRlcjogYmx1cig0cHgpO1xuICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7XG5cbiAgJi5hY3RpdmUge1xuICAgIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgfVxuXG4gICYgPiAjbWVybWFpZC1zcGFjZSB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1saWdodCk7XG4gICAgYm9yZGVyLXJhZGl1czogNXB4O1xuICAgIHBvc2l0aW9uOiBmaXhlZDtcbiAgICB0b3A6IDUwJTtcbiAgICBsZWZ0OiA1MCU7XG4gICAgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7XG4gICAgaGVpZ2h0OiA4MHZoO1xuICAgIHdpZHRoOiA4MHZ3O1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG5cbiAgICAmID4gLm1lcm1haWQtY29udGVudCB7XG4gICAgICBwYWRkaW5nOiAycmVtO1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgdHJhbnNmb3JtLW9yaWdpbjogMCAwO1xuICAgICAgdHJhbnNpdGlvbjogdHJhbnNmb3JtIDAuMXMgZWFzZTtcbiAgICAgIG92ZXJmbG93OiB2aXNpYmxlO1xuICAgICAgbWluLWhlaWdodDogMjAwcHg7XG4gICAgICBtaW4td2lkdGg6IDIwMHB4O1xuXG4gICAgICBwcmUge1xuICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgIGJvcmRlcjogbm9uZTtcbiAgICAgIH1cblxuICAgICAgc3ZnIHtcbiAgICAgICAgbWF4LXdpZHRoOiBub25lO1xuICAgICAgICBoZWlnaHQ6IGF1dG87XG4gICAgICB9XG4gICAgfVxuXG4gICAgJiA+IC5tZXJtYWlkLWNvbnRyb2xzIHtcbiAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICAgIGJvdHRvbTogMjBweDtcbiAgICAgIHJpZ2h0OiAyMHB4O1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGdhcDogOHB4O1xuICAgICAgcGFkZGluZzogOHB4O1xuICAgICAgYmFja2dyb3VuZDogdmFyKC0tbGlnaHQpO1xuICAgICAgYm9yZGVyOiAxcHggc29saWQgdmFyKC0tbGlnaHRncmF5KTtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDZweDtcbiAgICAgIGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICB6LWluZGV4OiAyO1xuXG4gICAgICAubWVybWFpZC1jb250cm9sLWJ1dHRvbiB7XG4gICAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICB3aWR0aDogMzJweDtcbiAgICAgICAgaGVpZ2h0OiAzMnB4O1xuICAgICAgICBwYWRkaW5nOiAwO1xuICAgICAgICBib3JkZXI6IDFweCBzb2xpZCB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodCk7XG4gICAgICAgIGNvbG9yOiB2YXIoLS1kYXJrKTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogNHB4O1xuICAgICAgICBjdXJzb3I6IHBvaW50ZXI7XG4gICAgICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICAgICAgZm9udC1mYW1pbHk6IHZhcigtLWJvZHlGb250KTtcbiAgICAgICAgdHJhbnNpdGlvbjogYWxsIDAuMnMgZWFzZTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICBiYWNrZ3JvdW5kOiB2YXIoLS1saWdodGdyYXkpO1xuICAgICAgICB9XG5cbiAgICAgICAgJjphY3RpdmUge1xuICAgICAgICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgxcHgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU3R5bGUgdGhlIHJlc2V0IGJ1dHRvbiBkaWZmZXJlbnRseVxuICAgICAgICAmOm50aC1jaGlsZCgyKSB7XG4gICAgICAgICAgd2lkdGg6IGF1dG87XG4gICAgICAgICAgcGFkZGluZzogMCAxMnB4O1xuICAgICAgICAgIGZvbnQtc2l6ZTogMTRweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19 */</style><link href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="../../../../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../../../../static/contentIndex.json").then(data => data.json())</script><link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://raibid-labs.github.io/docs/index.xml"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta property="og:image" content="https://raibid-labs.github.io/docs/projects/mop/docs/research/obi-comprehensive-research-og-image.webp"/><meta property="og:image:url" content="https://raibid-labs.github.io/docs/projects/mop/docs/research/obi-comprehensive-research-og-image.webp"/><meta name="twitter:image" content="https://raibid-labs.github.io/docs/projects/mop/docs/research/obi-comprehensive-research-og-image.webp"/><meta property="og:image:type" content="image/.webp"/></head><body data-slug="projects/mop/docs/research/obi-comprehensive-research"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h2 class="page-title"><a href="../../../..">Raibid Labs Documentation</a></h2><div class="spacer mobile-only"></div><div class="flex-component" style="flex-direction: row; flex-wrap: nowrap; gap: 1rem;"><div style="flex-grow: 1; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><div class="search"><button class="search-button"><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title>Search</title><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg><p>Search</p></button><div class="search-container"><div class="search-space"><input autocomplete="off" class="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div class="search-layout" data-preview="true"></div></div></div></div></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="darkmode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve" aria-label="Dark mode"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve" aria-label="Light mode"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></button></div><div style="flex-grow: 0; flex-shrink: 1; flex-basis: auto; order: 0; align-self: center; justify-self: center;"><button class="readermode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" class="readerIcon" fill="currentColor" stroke="currentColor" stroke-width="0.2" stroke-linecap="round" stroke-linejoin="round" width="64px" height="64px" viewBox="0 0 24 24" aria-label="Reader mode"><title>Reader mode</title><g transform="translate(-1.8, -1.8) scale(1.15, 1.2)"><path d="M8.9891247,2.5 C10.1384702,2.5 11.2209868,2.96705384 12.0049645,3.76669482 C12.7883914,2.96705384 13.8709081,2.5 15.0202536,2.5 L18.7549359,2.5 C19.1691495,2.5 19.5049359,2.83578644 19.5049359,3.25 L19.5046891,4.004 L21.2546891,4.00457396 C21.6343849,4.00457396 21.9481801,4.28672784 21.9978425,4.6528034 L22.0046891,4.75457396 L22.0046891,20.25 C22.0046891,20.6296958 21.7225353,20.943491 21.3564597,20.9931534 L21.2546891,21 L2.75468914,21 C2.37499337,21 2.06119817,20.7178461 2.01153575,20.3517706 L2.00468914,20.25 L2.00468914,4.75457396 C2.00468914,4.37487819 2.28684302,4.061083 2.65291858,4.01142057 L2.75468914,4.00457396 L4.50368914,4.004 L4.50444233,3.25 C4.50444233,2.87030423 4.78659621,2.55650904 5.15267177,2.50684662 L5.25444233,2.5 L8.9891247,2.5 Z M4.50368914,5.504 L3.50468914,5.504 L3.50468914,19.5 L10.9478955,19.4998273 C10.4513189,18.9207296 9.73864328,18.5588115 8.96709342,18.5065584 L8.77307039,18.5 L5.25444233,18.5 C4.87474657,18.5 4.56095137,18.2178461 4.51128895,17.8517706 L4.50444233,17.75 L4.50368914,5.504 Z M19.5049359,17.75 C19.5049359,18.1642136 19.1691495,18.5 18.7549359,18.5 L15.2363079,18.5 C14.3910149,18.5 13.5994408,18.8724714 13.0614828,19.4998273 L20.5046891,19.5 L20.5046891,5.504 L19.5046891,5.504 L19.5049359,17.75 Z M18.0059359,3.999 L15.0202536,4 L14.8259077,4.00692283 C13.9889509,4.06666544 13.2254227,4.50975805 12.7549359,5.212 L12.7549359,17.777 L12.7782651,17.7601316 C13.4923805,17.2719483 14.3447024,17 15.2363079,17 L18.0059359,16.999 L18.0056891,4.798 L18.0033792,4.75457396 L18.0056891,4.71 L18.0059359,3.999 Z M8.9891247,4 L6.00368914,3.999 L6.00599909,4.75457396 L6.00599909,4.75457396 L6.00368914,4.783 L6.00368914,16.999 L8.77307039,17 C9.57551536,17 10.3461406,17.2202781 11.0128313,17.6202194 L11.2536891,17.776 L11.2536891,5.211 C10.8200889,4.56369974 10.1361548,4.13636104 9.37521067,4.02745763 L9.18347055,4.00692283 L8.9891247,4 Z"></path></g></svg></button></div></div><div class="explorer" data-behavior="link" data-collapsed="collapsed" data-savestate="true" data-data-fns="{&quot;order&quot;:[&quot;filter&quot;,&quot;map&quot;,&quot;sort&quot;],&quot;sortFn&quot;:&quot;(a,b)=>!a.isFolder&amp;&amp;!b.isFolder||a.isFolder&amp;&amp;b.isFolder?a.displayName.localeCompare(b.displayName,void 0,{numeric:!0,sensitivity:\&quot;base\&quot;}):!a.isFolder&amp;&amp;b.isFolder?1:-1&quot;,&quot;filterFn&quot;:&quot;node=>node.slugSegment!==\&quot;tags\&quot;&quot;,&quot;mapFn&quot;:&quot;node=>node&quot;}"><button type="button" class="explorer-toggle mobile-explorer hide-until-loaded" data-mobile="true" aria-controls="explorer-388"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide-menu"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><button type="button" class="title-button explorer-toggle desktop-explorer" data-mobile="false" aria-expanded="true"><h2>Explorer</h2><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-388" class="explorer-content" aria-expanded="false" role="group"><ul class="explorer-ul overflow" id="list-0"><li class="overflow-end"></li></ul></div><template id="template-file"><li><a href="#"></a></li></template><template id="template-folder"><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div><button class="folder-button"><span class="folder-title"></span></button></div></div><div class="folder-outer"><ul class="content"></ul></div></li></template></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../../../../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../projects/">Projects</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../projects/mop/">mop</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../projects/mop/docs/">docs</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../../../../projects/mop/docs/research/">research</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>obi comprehensive research</a></div></nav><h1 class="article-title">obi-comprehensive-research</h1><p show-comma="true" class="content-meta"><time datetime="2025-11-16T03:15:11.447Z">Nov 16, 2025</time><span>33 min read</span></p><ul class="tags"><li><a href="../../../../tags/grafana" class="internal tag-link">grafana</a></li></ul></div></div><article class="popover-hint"><h1 id="opentelemetry-backend-initiative-obi---comprehensive-research-report">OpenTelemetry Backend Initiative (OBI) - Comprehensive Research Report<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#opentelemetry-backend-initiative-obi---comprehensive-research-report" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h1>
<p><strong>Research Date:</strong> November 6, 2025
<strong>Status:</strong> Alpha Release (November 3, 2025)</p>
<h2 id="table-of-contents">Table of Contents<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#table-of-contents" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ol>
<li><a href="#executive-summary" class="internal alias">Executive Summary</a></li>
<li><a href="#what-is-obi" class="internal alias">What is OBI?</a></li>
<li><a href="#first-release-details" class="internal alias">First Release Details</a></li>
<li><a href="#architecture--technical-design" class="internal alias">Architecture &amp; Technical Design</a></li>
<li><a href="#integration-with-grafana-stack" class="internal alias">Integration with Grafana Stack</a></li>
<li><a href="#deployment-strategies" class="internal alias">Deployment Strategies</a></li>
<li><a href="#key-use-cases" class="internal alias">Key Use Cases</a></li>
<li><a href="#experimental-implementations" class="internal alias">Experimental Implementations</a></li>
<li><a href="#helm-charts--kubernetes" class="internal alias">Helm Charts &amp; Kubernetes</a></li>
<li><a href="#comparison-with-traditional-backends" class="internal alias">Comparison with Traditional Backends</a></li>
<li><a href="#recommendations" class="internal alias">Recommendations</a></li>
</ol>
<hr/>
<h2 id="executive-summary">Executive Summary<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#executive-summary" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p><strong>OpenTelemetry eBPF Instrumentation (OBI)</strong> represents a paradigm shift in observability, providing zero-code instrumentation through kernel-level eBPF technology. Released as alpha on November 3, 2025, OBI originated from Grafana Beyla and was donated to the OpenTelemetry project to accelerate community-driven development.</p>
<p><strong>Key Highlights:</strong></p>
<ul>
<li><strong>Zero Application Impact</strong>: No code changes, restarts, or configuration modifications required</li>
<li><strong>Minimal Overhead</strong>: Less than 1% CPU usage, far lower than traditional SDKs</li>
<li><strong>Language Agnostic</strong>: Works with Java, .NET, Go, Python, Ruby, Node.js, and more</li>
<li><strong>Protocol Coverage</strong>: HTTP/S, HTTP/2, gRPC, SQL, Redis, MongoDB, Kafka, GraphQL, S3</li>
<li><strong>Production Ready</strong>: Donated by Grafana Labs with 19,000+ lines of production-tested code</li>
</ul>
<hr/>
<h2 id="what-is-obi">What is OBI?<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#what-is-obi" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="definition">Definition<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#definition" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>OpenTelemetry eBPF Instrumentation (OBI) is an <strong>out-of-process auto-instrumentation tool</strong> that uses eBPF (extended Berkeley Packet Filter) to capture telemetry at the kernel level, providing metrics and distributed traces without modifying application code.</p>
<h3 id="core-concept">Core Concept<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#core-concept" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Unlike traditional OpenTelemetry instrumentation that operates at the library level within the application process, OBI operates at the <strong>protocol level</strong> in the kernel. This fundamental difference enables:</p>
<ol>
<li><strong>Zero-Code Instrumentation</strong>: Fully automatic capture without any application changes</li>
<li><strong>Universal Language Support</strong>: Works with any language that makes system calls</li>
<li><strong>Consistent Telemetry</strong>: Same telemetry format across all languages and frameworks</li>
<li><strong>Minimal Performance Impact</strong>: Kernel-level efficiency with &lt; 1% CPU overhead</li>
</ol>
<h3 id="origins">Origins<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#origins" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Developed By</strong>: Grafana Labs (originally named “Beyla”)</li>
<li><strong>Donated To</strong>: OpenTelemetry Project (May 2025)</li>
<li><strong>First Release</strong>: November 3, 2025 (Alpha)</li>
<li><strong>Primary Contributors</strong>: Nikola Grcevski (Grafana Labs), Tyler Yahn (Splunk), Coralogix (19K+ LOC)</li>
</ul>
<hr/>
<h2 id="first-release-details">First Release Details<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#first-release-details" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="release-information">Release Information<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#release-information" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Date</strong>: November 3, 2025</li>
<li><strong>Status</strong>: Alpha Release</li>
<li><strong>Announcement</strong>: <a href="https://opentelemetry.io/blog/2025/obi-announcing-first-release/" class="external">OpenTelemetry Blog<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Authors</strong>: Nikola Grcevski (Grafana Labs), Tyler Yahn (Splunk)</li>
</ul>
<h3 id="key-features-in-v10-alpha">Key Features in v1.0 Alpha<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#key-features-in-v10-alpha" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="supported-protocols">Supported Protocols<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#supported-protocols" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><strong>Web</strong>: HTTP/HTTPS, HTTP/2, gRPC</li>
<li><strong>Databases</strong>: SQL (PostgreSQL, MySQL), Redis, MongoDB</li>
<li><strong>Message Queues</strong>: Kafka</li>
<li><strong>APIs</strong>: GraphQL, REST</li>
<li><strong>Cloud Services</strong>: AWS S3, Elasticsearch/OpenSearch</li>
</ul>
<h4 id="telemetry-capabilities">Telemetry Capabilities<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#telemetry-capabilities" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><strong>Metrics</strong>: RED (Request rate, Error rate, Duration) metrics</li>
<li><strong>Traces</strong>: Distributed tracing with automatic context propagation</li>
<li><strong>Export</strong>: OTLP (OpenTelemetry Protocol) to any OTLP-compatible backend</li>
</ul>
<h4 id="performance-characteristics">Performance Characteristics<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#performance-characteristics" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul>
<li><strong>CPU Overhead</strong>: &lt; 1% in production workloads</li>
<li><strong>Memory Footprint</strong>: Minimal compared to in-process SDKs (10-50x reduction)</li>
<li><strong>Latency Impact</strong>: Zero application latency impact (kernel-level operation)</li>
</ul>
<h3 id="current-limitations">Current Limitations<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#current-limitations" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>The alpha release has documented constraints:</p>
<ol>
<li><strong>Reactive Programming</strong>: Limited support for reactive frameworks (Project Reactor, RxJava)</li>
<li><strong>Java Virtual Threads</strong>: Not yet supported (preview feature in Java 21+)</li>
<li><strong>Complex Thread Pools</strong>: Limited support for advanced threading patterns</li>
<li><strong>Generic Telemetry</strong>: Provides protocol-level data, not application-specific custom attributes</li>
</ol>
<p><strong>Recommendation</strong>: Use OBI alongside traditional instrumentation for complementary coverage.</p>
<hr/>
<h2 id="architecture--technical-design">Architecture &amp; Technical Design<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#architecture--technical-design" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="high-level-architecture">High-Level Architecture<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#high-level-architecture" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│                      User Space                              │
│  ┌──────────────────────────────────────────────────────┐   │
│  │           OBI Agent (User Space)                      │   │
│  │  - Reads eBPF maps                                    │   │
│  │  - Processes &amp; enriches telemetry                     │   │
│  │  - Adds K8s metadata (pod, namespace, deployment)    │   │
│  │  - Exports via OTLP                                   │   │
│  └──────────────────────────────────────────────────────┘   │
│                           ▲                                  │
│                           │ eBPF Maps                        │
└───────────────────────────┼──────────────────────────────────┘
                            │
┌───────────────────────────┼──────────────────────────────────┐
│                    Kernel Space                              │
│  ┌──────────────────────────────────────────────────────┐   │
│  │           eBPF Probes (Kernel)                        │   │
│  │  - kprobes: kernel function tracing                   │   │
│  │  - uprobes: user-space function tracing               │   │
│  │  - tracepoints: static kernel instrumentation         │   │
│  │  - Network hooks: socket operations                   │   │
│  │  - Captures: syscalls, network packets, I/O           │   │
│  └──────────────────────────────────────────────────────┘   │
│                           ▲                                  │
└───────────────────────────┼──────────────────────────────────┘
                            │
                     Application Processes
</code></pre>
<h3 id="components">Components<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#components" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="1-kernel-space-ebpf-probes">1. Kernel-Space eBPF Probes<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-kernel-space-ebpf-probes" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Function</strong>: Capture raw network, process, and application telemetry data</p>
<p><strong>Types of Probes</strong>:</p>
<ul>
<li><strong>kprobes</strong>: Dynamic kernel function tracing</li>
<li><strong>uprobes</strong>: User-space application function tracing</li>
<li><strong>tracepoints</strong>: Static kernel instrumentation points</li>
<li><strong>socket hooks</strong>: Network-level packet inspection</li>
</ul>
<p><strong>Data Captured</strong>:</p>
<ul>
<li>HTTP request/response metadata (method, path, status, headers)</li>
<li>SQL queries (sanitized for security)</li>
<li>gRPC calls and responses</li>
<li>Network socket operations (connect, send, recv)</li>
<li>Process context (PID, TID, namespace)</li>
</ul>
<p><strong>Storage</strong>: Captured data stored in highly efficient <strong>eBPF maps</strong> (kernel memory)</p>
<h4 id="2-user-space-obi-agent">2. User-Space OBI Agent<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-user-space-obi-agent" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Function</strong>: Process and export telemetry from eBPF maps</p>
<p><strong>Responsibilities</strong>:</p>
<ol>
<li><strong>Read eBPF Maps</strong>: Continuously poll kernel maps for telemetry data</li>
<li><strong>Process Data</strong>: Parse protocol-specific data (HTTP, gRPC, SQL, etc.)</li>
<li><strong>Enrich Metadata</strong>: Add Kubernetes context (pod, namespace, labels, annotations)</li>
<li><strong>Build Traces</strong>: Construct distributed trace spans with context propagation</li>
<li><strong>Export Telemetry</strong>: Send metrics and traces via OTLP to backends</li>
</ol>
<p><strong>Context Propagation Methods</strong>:</p>
<ul>
<li><strong>Network-level</strong>: Extract trace context from HTTP headers (traceparent, b3)</li>
<li><strong>Memory-level</strong>: Share trace context between processes via shared memory</li>
</ul>
<h3 id="how-it-works-http-request-example">How It Works: HTTP Request Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#how-it-works-http-request-example" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<pre><code>1. Application makes HTTP request
   ↓
2. eBPF probe attached to socket send() syscall captures:
   - Request headers (including traceparent)
   - HTTP method, path
   - Timestamp (start)
   ↓
3. Data stored in eBPF map (kernel memory)
   ↓
4. eBPF probe on socket recv() captures response:
   - Status code
   - Response headers
   - Timestamp (end)
   ↓
5. User-space agent reads eBPF map:
   - Calculates duration (end - start)
   - Extracts trace context
   - Enriches with K8s metadata
   ↓
6. Agent creates OTLP span and exports to backend
</code></pre>
<h3 id="comparison-traditional-vs-ebpf-instrumentation">Comparison: Traditional vs eBPF Instrumentation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#comparison-traditional-vs-ebpf-instrumentation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>


















































<div class="table-container"><table><thead><tr><th>Aspect</th><th>Traditional SDK</th><th>OBI (eBPF)</th></tr></thead><tbody><tr><td><strong>Installation</strong></td><td>Add SDK to application</td><td>Deploy agent (DaemonSet)</td></tr><tr><td><strong>Code Changes</strong></td><td>Required (import, configure)</td><td>None</td></tr><tr><td><strong>Restart Required</strong></td><td>Yes</td><td>No</td></tr><tr><td><strong>Language Support</strong></td><td>Per-language SDKs</td><td>Universal (kernel-level)</td></tr><tr><td><strong>Performance Impact</strong></td><td>5-15% CPU, high memory</td><td>&lt; 1% CPU, minimal memory</td></tr><tr><td><strong>Custom Attributes</strong></td><td>Full support</td><td>Limited (protocol-level only)</td></tr><tr><td><strong>Protocol Coverage</strong></td><td>Library-dependent</td><td>Protocol-level (HTTP, gRPC, SQL)</td></tr><tr><td><strong>Maintenance</strong></td><td>Update each service</td><td>Centralized agent updates</td></tr></tbody></table></div>
<hr/>
<h2 id="integration-with-grafana-stack">Integration with Grafana Stack<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#integration-with-grafana-stack" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="lgtm-stack-overview">LGTM Stack Overview<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#lgtm-stack-overview" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>LGTM</strong> = <strong>L</strong>oki + <strong>G</strong>rafana + <strong>T</strong>empo + <strong>M</strong>imir (+ <strong>A</strong>lloy)</p>
<p>The Grafana observability stack provides a complete, open-source solution for logs, metrics, traces, and profiling.</p>
<h3 id="components-1">Components<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#components-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="1-grafana-alloy">1. Grafana Alloy<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-grafana-alloy" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Role</strong>: <strong>Unified telemetry aggregation and routing</strong></p>
<p><strong>Key Features</strong>:</p>
<ul>
<li>OpenTelemetry Collector distribution (vendor-neutral)</li>
<li>Programmable pipelines with River configuration language</li>
<li>Supports OpenTelemetry, Prometheus, and custom protocols</li>
<li>Built-in transformations, filtering, and routing</li>
</ul>
<p><strong>Integration with OBI</strong>:</p>
<ul>
<li>Alloy receives OTLP data from OBI agent</li>
<li>Routes traces to Tempo</li>
<li>Routes metrics to Mimir</li>
<li>Routes logs to Loki</li>
<li>Performs filtering, sampling, and enrichment</li>
</ul>
<p><strong>Configuration Example</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="hcl" data-theme="github-light one-dark-pro"><code data-language="hcl" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Receive OTLP from OBI</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">receiver</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">otlp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;obi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  grpc {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;0.0.0.0:4317&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  http {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;0.0.0.0:4318&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  output {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    traces</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">  =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [otelcol.processor.batch.default.input]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    metrics</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [otelcol.processor.batch.default.input]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Batch processing</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processor</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">batch</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;default&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  output {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    traces</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">  =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [otelcol.exporter.otlp.tempo.input]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    metrics</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [otelcol.exporter.prometheus.mimir.input]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Export to Tempo</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exporter</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">otlp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tempo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  client {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tempo:4317&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Export to Mimir</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exporter</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">prometheus</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;mimir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;http://mimir:9009/api/v1/push&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<h4 id="2-grafana-tempo">2. Grafana Tempo<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-grafana-tempo" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Role</strong>: <strong>Distributed tracing backend</strong></p>
<p><strong>Key Features</strong>:</p>
<ul>
<li>Cost-efficient (object storage only, no index)</li>
<li>Deeply integrated with Grafana, Prometheus, Loki</li>
<li>Supports Jaeger, Zipkin, OpenTelemetry protocols</li>
<li>TraceQL query language for powerful trace search</li>
</ul>
<p><strong>OBI Integration</strong>:</p>
<ul>
<li>Receives trace spans from OBI via Alloy</li>
<li>Stores traces in object storage (S3, GCS, Azure Blob)</li>
<li>Provides trace visualization in Grafana</li>
<li>Correlates traces with metrics (exemplars) and logs</li>
</ul>
<p><strong>Benefits for OBI</strong>:</p>
<ul>
<li>No trace indexing = low cost at scale</li>
<li>Query traces by service, operation, duration, tags</li>
<li>Automatic correlation with RED metrics from OBI</li>
</ul>
<h4 id="3-grafana-loki">3. Grafana Loki<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-grafana-loki" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Role</strong>: <strong>Log aggregation system</strong></p>
<p><strong>Key Features</strong>:</p>
<ul>
<li>Horizontally scalable, multi-tenant</li>
<li>Indexes labels, not log content (cost-efficient)</li>
<li>Inspired by Prometheus label model</li>
<li>LogQL query language</li>
</ul>
<p><strong>OBI Integration</strong>:</p>
<ul>
<li>OBI doesn’t capture logs directly (protocol-level only)</li>
<li><strong>Correlation via trace context</strong>: Logs enriched with trace_id</li>
<li>Query logs for a specific trace: <code>{trace_id=&quot;abc123&quot;}</code></li>
<li>Grafana UI shows traces and related logs side-by-side</li>
</ul>
<p><strong>Use Case</strong>:</p>
<ol>
<li>OBI captures trace showing 500 error</li>
<li>User clicks “Show Logs” in Grafana trace view</li>
<li>Loki queries logs with same trace_id</li>
<li>Root cause revealed in application logs</li>
</ol>
<h4 id="4-grafana-mimir">4. Grafana Mimir<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#4-grafana-mimir" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Role</strong>: <strong>Long-term Prometheus metrics storage</strong></p>
<p><strong>Key Features</strong>:</p>
<ul>
<li>Horizontally scalable for millions of metrics</li>
<li>Compatible with Prometheus (remote_write)</li>
<li>Multi-tenant with per-tenant limits</li>
<li>Fast query performance with sharding</li>
</ul>
<p><strong>OBI Integration</strong>:</p>
<ul>
<li>OBI exports RED metrics (request rate, error rate, duration)</li>
<li>Alloy forwards metrics to Mimir</li>
<li>Store metrics for long-term analysis (months/years)</li>
<li>Visualize in Grafana dashboards</li>
</ul>
<p><strong>Metrics from OBI</strong>:</p>
<pre><code># HTTP metrics
http_server_duration_seconds{service=&quot;api&quot;, method=&quot;GET&quot;, path=&quot;/users&quot;, status=&quot;200&quot;}
http_server_request_rate{service=&quot;api&quot;}
http_server_error_rate{service=&quot;api&quot;}

# gRPC metrics
rpc_server_duration_seconds{service=&quot;grpc-backend&quot;, method=&quot;/api.UserService/GetUser&quot;}

# SQL metrics
db_client_duration_seconds{service=&quot;api&quot;, db_system=&quot;postgresql&quot;, operation=&quot;SELECT&quot;}
</code></pre>
<h4 id="5-grafana-visualization">5. Grafana (Visualization)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#5-grafana-visualization" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Role</strong>: <strong>Unified observability UI</strong></p>
<p><strong>Key Features</strong>:</p>
<ul>
<li>Dashboards for metrics, logs, traces, profiles</li>
<li>Explore view for ad-hoc queries</li>
<li>Automatic correlation between signals</li>
<li>Alerting and notification</li>
</ul>
<p><strong>OBI + LGTM Workflow</strong>:</p>
<ol>
<li><strong>Dashboard</strong>: View RED metrics from Mimir (powered by OBI)</li>
<li><strong>Click spike</strong>: Drill down to traces in Tempo</li>
<li><strong>Select slow trace</strong>: See distributed trace spans (OBI-captured)</li>
<li><strong>Click span</strong>: View related logs from Loki</li>
<li><strong>Root cause</strong>: Identify slow database query or external API call</li>
</ol>
<h3 id="architecture-diagram-obi--lgtm-stack">Architecture Diagram: OBI + LGTM Stack<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#architecture-diagram-obi--lgtm-stack" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<pre><code>┌─────────────────────────────────────────────────────────────────┐
│                    Kubernetes Cluster                            │
│                                                                   │
│  ┌──────────────┐      ┌──────────────┐      ┌──────────────┐  │
│  │ Application  │      │ Application  │      │ Application  │  │
│  │   Pod 1      │      │   Pod 2      │      │   Pod 3      │  │
│  └──────────────┘      └──────────────┘      └──────────────┘  │
│         │                     │                     │            │
│         │ (eBPF instrumentation at kernel level)    │            │
│         │                     │                     │            │
│  ┌──────┼─────────────────────┼─────────────────────┼──────┐   │
│  │      ▼                     ▼                     ▼       │   │
│  │  ┌──────────────────────────────────────────────────┐   │   │
│  │  │        OBI DaemonSet (one per node)              │   │   │
│  │  │  - eBPF probes capture HTTP, gRPC, SQL, etc.    │   │   │
│  │  │  - Exports OTLP to Alloy                        │   │   │
│  │  └──────────────────────────────────────────────────┘   │   │
│  │                         │                                 │   │
│  │                         │ OTLP (traces, metrics)          │   │
│  │                         ▼                                 │   │
│  │  ┌──────────────────────────────────────────────────┐   │   │
│  │  │        Grafana Alloy (StatefulSet)               │   │   │
│  │  │  - Receives OTLP                                 │   │   │
│  │  │  - Routes traces → Tempo                         │   │   │
│  │  │  - Routes metrics → Mimir                        │   │   │
│  │  │  - Sampling, filtering, enrichment               │   │   │
│  │  └──────────────────────────────────────────────────┘   │   │
│  │              │                      │                     │   │
│  └──────────────┼──────────────────────┼─────────────────────┘   │
│                 │                      │                         │
└─────────────────┼──────────────────────┼─────────────────────────┘
                  │                      │
          Traces  │              Metrics │
                  ▼                      ▼
       ┌─────────────────┐    ┌─────────────────┐
       │  Grafana Tempo  │    │  Grafana Mimir  │
       │  (Traces)       │    │  (Metrics)      │
       │  - Object store │    │  - Long-term    │
       │  - TraceQL      │    │  - PromQL       │
       └─────────────────┘    └─────────────────┘
                  │                      │
                  └──────────┬───────────┘
                             │
                             ▼
                  ┌─────────────────┐
                  │    Grafana      │
                  │  (Visualization)│
                  │  - Dashboards   │
                  │  - Explore      │
                  │  - Alerts       │
                  └─────────────────┘
</code></pre>
<hr/>
<h2 id="deployment-strategies">Deployment Strategies<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#deployment-strategies" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="alloy-operator-vs-standalone-deployment">Alloy Operator vs Standalone Deployment<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#alloy-operator-vs-standalone-deployment" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="alloy-operator-recommended-for-production">Alloy Operator (Recommended for Production)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#alloy-operator-recommended-for-production" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Overview</strong>: Kubernetes operator that manages Alloy lifecycle declaratively</p>
<p><strong>Key Advantages</strong>:</p>
<ol>
<li><strong>Declarative Configuration</strong>: Manage via <code>kind: Alloy</code> custom resources</li>
<li><strong>Automatic Configuration</strong>: Operator configures Alloy based on high-level settings</li>
<li><strong>Simplified Management</strong>: Single Helm chart deploys operator + Alloy instances</li>
<li><strong>Dynamic Scaling</strong>: Automatically adjusts based on load and requirements</li>
<li><strong>Built-in Best Practices</strong>: Default configurations follow Grafana recommendations</li>
</ol>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Production Kubernetes environments</li>
<li>Multi-tenant deployments requiring isolation</li>
<li>Dynamic workloads with auto-scaling needs</li>
<li>Teams preferring declarative GitOps workflows</li>
</ul>
<p><strong>Installation</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Add Grafana Helm repo</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://grafana.github.io/helm-charts</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Install Alloy Operator</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy-operator</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana/alloy-operator</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy-system</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Deploy Alloy instance</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> apply</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -f</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> -</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;"> &lt;&lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">EOF</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">apiVersion: alloy.grafana.com/v1alpha1</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">kind: Alloy</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">metadata:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  name: alloy-main</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  namespace: alloy-system</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">spec:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  mode: deployment</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  replicas: 3</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">  config: |</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    otelcol.receiver.otlp &quot;obi&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      grpc { endpoint = &quot;0.0.0.0:4317&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      http { endpoint = &quot;0.0.0.0:4318&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        traces = [otelcol.processor.batch.default.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    otelcol.processor.batch &quot;default&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        traces = [otelcol.exporter.otlp.tempo.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    otelcol.exporter.otlp &quot;tempo&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      client {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        endpoint = &quot;tempo:4317&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#ABB2BF;">EOF</span></span></code></pre></figure>
<p><strong>Pros</strong>:</p>
<ul>
<li>Less operational overhead (operator handles updates)</li>
<li>Consistent configuration across clusters</li>
<li>Easier to scale and manage multiple instances</li>
<li>Built-in health checks and auto-remediation</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Additional complexity (operator + CRDs)</li>
<li>Requires cluster-admin permissions to install operator</li>
<li>Learning curve for Alloy CRD schema</li>
</ul>
<h4 id="standalone-helm-deployment">Standalone Helm Deployment<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#standalone-helm-deployment" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Overview</strong>: Direct Helm chart deployment without operator</p>
<p><strong>Key Advantages</strong>:</p>
<ol>
<li><strong>Direct Control</strong>: Full control over Helm chart values</li>
<li><strong>Simpler Architecture</strong>: No operator dependency</li>
<li><strong>Faster Initial Setup</strong>: Single Helm install command</li>
<li><strong>Flexible Deployment Modes</strong>: DaemonSet, Deployment, StatefulSet</li>
</ol>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Development and testing environments</li>
<li>Smaller deployments without complex requirements</li>
<li>Teams preferring Helm-based workflows</li>
<li>Environments with limited cluster permissions</li>
</ul>
<p><strong>Installation</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Install Alloy standalone</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana/alloy</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> controller.type=deployment</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> controller.replicas=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set-file</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config.content=alloy-config.yaml</span></span></code></pre></figure>
<p><strong>Pros</strong>:</p>
<ul>
<li>Simpler architecture (no operator)</li>
<li>Lower permission requirements</li>
<li>Direct Helm value control</li>
<li>Easier to understand for Helm users</li>
</ul>
<p><strong>Cons</strong>:</p>
<ul>
<li>Manual configuration updates required</li>
<li>No automatic optimization or scaling</li>
<li>More operational overhead for multi-instance setups</li>
</ul>
<h3 id="deployment-patterns">Deployment Patterns<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#deployment-patterns" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="1-daemonset-node-level-collection">1. DaemonSet (Node-Level Collection)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-daemonset-node-level-collection" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Use Case</strong>: Node-level metrics, pod logs, host monitoring</p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>One pod per Kubernetes node</li>
<li>Access to host network and filesystem</li>
<li>Collects node-level metrics (cAdvisor, kubelet)</li>
</ul>
<p><strong>Configuration</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">daemonset</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  hostNetwork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Access host network</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  hostPID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      # Access host processes</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">hostfs</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    hostPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/</span></span></code></pre></figure>
<p><strong>Best For</strong>:</p>
<ul>
<li>OBI DaemonSet deployment (kernel-level access required)</li>
<li>Node exporter metrics</li>
<li>Log collection from all pods</li>
</ul>
<h4 id="2-deployment-stateless-workload">2. Deployment (Stateless Workload)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-deployment-stateless-workload" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Use Case</strong>: General telemetry aggregation, stateless processing</p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>Standard deployment with N replicas</li>
<li>No persistent storage or stable identities</li>
<li>Horizontal scaling via replica count</li>
</ul>
<p><strong>Configuration</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">deployment</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">autoscaling</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  minReplicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  maxReplicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  targetCPUUtilizationPercentage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">70</span></span></code></pre></figure>
<p><strong>Best For</strong>:</p>
<ul>
<li>OTLP receiver endpoints</li>
<li>Stateless metric exporters</li>
<li>Gateway deployments</li>
</ul>
<h4 id="3-statefulset-stateful-workload">3. StatefulSet (Stateful Workload)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-statefulset-stateful-workload" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Use Case</strong>: Prometheus scraping, clustered mode, persistent WAL</p>
<p><strong>Characteristics</strong>:</p>
<ul>
<li>Stable network identities (alloy-0, alloy-1, etc.)</li>
<li>Persistent volumes per pod</li>
<li>Ordered deployment and scaling</li>
</ul>
<p><strong>Configuration</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">statefulset</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">persistence</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">10Gi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  storageClass</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">fast-ssd</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">clustering</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span></code></pre></figure>
<p><strong>Best For</strong>:</p>
<ul>
<li>Prometheus metrics collection (persistent WAL)</li>
<li>Clustered Alloy instances with data distribution</li>
<li>Any workload requiring persistent state</li>
</ul>
<h3 id="obi-deployment-pattern">OBI Deployment Pattern<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#obi-deployment-pattern" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Recommended Setup</strong>: Two-tier architecture</p>
<h4 id="tier-1-obi-daemonset">Tier 1: OBI DaemonSet<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tier-1-obi-daemonset" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Purpose</strong>: Capture telemetry at node level</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">apps/v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">DaemonSet</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-agent</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">observability</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  selector</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    matchLabels</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-agent</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      labels</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        app</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-agent</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      hostNetwork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      hostPID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      serviceAccountName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-agent</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      containers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        image</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">grafana/beyla:latest</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        securityContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          privileged</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Required for eBPF</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          capabilities</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">            add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">SYS_ADMIN</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">SYS_PTRACE</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">NET_ADMIN</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">BEYLA_OPEN_PORT</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8080,8443,9090&quot;</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Ports to instrument</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">OTEL_EXPORTER_OTLP_ENDPOINT</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://alloy-gateway:4317&quot;</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        volumeMounts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">hostfs</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          mountPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/hostfs</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          readOnly</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      volumes</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">hostfs</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        hostPath</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/</span></span></code></pre></figure>
<h4 id="tier-2-alloy-gateway-statefulset-or-deployment">Tier 2: Alloy Gateway (StatefulSet or Deployment)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tier-2-alloy-gateway-statefulset-or-deployment" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Purpose</strong>: Aggregate, process, route telemetry</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Using Alloy Operator</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">alloy.grafana.com/v1alpha1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Alloy</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">alloy-gateway</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">observability</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  mode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">statefulset</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  clustering</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    // Receive from OBI</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    otelcol.receiver.otlp &quot;obi&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      grpc { endpoint = &quot;0.0.0.0:4317&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      http { endpoint = &quot;0.0.0.0:4318&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        traces = [otelcol.processor.tail_sampling.default.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    // Tail-based sampling for cost optimization</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    otelcol.processor.tail_sampling &quot;default&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      policies = [</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          name = &quot;errors&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          type = &quot;status_code&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          status_code = { status_codes = [&quot;ERROR&quot;] }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        },</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          name = &quot;slow&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          type = &quot;latency&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          latency = { threshold_ms = 1000 }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        },</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          name = &quot;sample&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          type = &quot;probabilistic&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          probabilistic = { sampling_percentage = 10 }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      ]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        traces = [otelcol.exporter.otlp.tempo.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    // Export to Tempo</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    otelcol.exporter.otlp &quot;tempo&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      client {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        endpoint = &quot;tempo-distributor:4317&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        tls { insecure = true }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    }</span></span></code></pre></figure>
<h3 id="decision-matrix-operator-vs-standalone">Decision Matrix: Operator vs Standalone<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#decision-matrix-operator-vs-standalone" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>













































<div class="table-container"><table><thead><tr><th>Criteria</th><th>Operator</th><th>Standalone</th></tr></thead><tbody><tr><td><strong>Cluster Size</strong></td><td>Large (100+ nodes)</td><td>Small/Medium (&lt; 100 nodes)</td></tr><tr><td><strong>Team Experience</strong></td><td>K8s operators, CRDs</td><td>Helm charts</td></tr><tr><td><strong>Deployment Model</strong></td><td>GitOps, declarative</td><td>Imperative, Helm</td></tr><tr><td><strong>Complexity Tolerance</strong></td><td>High (automated)</td><td>Low (manual)</td></tr><tr><td><strong>Multi-Tenancy</strong></td><td>Native support</td><td>Manual configuration</td></tr><tr><td><strong>Auto-Scaling</strong></td><td>Built-in</td><td>Manual HPA</td></tr><tr><td><strong>Best Fit</strong></td><td>Production, enterprise</td><td>Dev, test, small prod</td></tr></tbody></table></div>
<hr/>
<h2 id="key-use-cases">Key Use Cases<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#key-use-cases" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="1-zero-code-instrumentation-for-legacy-applications">1. Zero-Code Instrumentation for Legacy Applications<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-zero-code-instrumentation-for-legacy-applications" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem</strong>: Monolithic applications running on outdated runtimes (Java 8, Python 2.7) without OpenTelemetry support</p>
<p><strong>Solution</strong>: Deploy OBI as DaemonSet to automatically instrument without code changes</p>
<p><strong>Benefits</strong>:</p>
<ul>
<li>No SDK installation or code modifications</li>
<li>Works with unsupported language versions</li>
<li>Instant observability for previously “black box” services</li>
<li>Risk-free deployment (no application restart)</li>
</ul>
<p><strong>Example</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># OBI automatically instruments legacy Java 8 app</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">apps/v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">DaemonSet</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-legacy</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      containers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        image</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">grafana/beyla:latest</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">BEYLA_SERVICE_NAME</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;legacy-java8-monolith&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">BEYLA_OPEN_PORT</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          value</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8080&quot;</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Java app HTTP port</span></span></code></pre></figure>
<p><strong>Real-World Impact</strong>:</p>
<ul>
<li><strong>Before OBI</strong>: No traces, manual log analysis, blind to performance issues</li>
<li><strong>After OBI</strong>: Full distributed tracing, RED metrics, automatic root cause analysis</li>
</ul>
<h3 id="2-multi-protocol-service-observability">2. Multi-Protocol Service Observability<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-multi-protocol-service-observability" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem</strong>: Microservices using mixed protocols (HTTP REST, gRPC, SQL, Redis, Kafka) require separate instrumentation</p>
<p><strong>Solution</strong>: OBI provides unified instrumentation across all protocols</p>
<p><strong>Supported Protocols</strong>:</p>
<ul>
<li><strong>Web</strong>: HTTP/1.1, HTTP/2, HTTPS, gRPC</li>
<li><strong>Databases</strong>: PostgreSQL, MySQL, Redis, MongoDB</li>
<li><strong>Message Queues</strong>: Kafka</li>
<li><strong>APIs</strong>: REST, GraphQL, gRPC</li>
<li><strong>Cloud</strong>: AWS S3, Elasticsearch</li>
</ul>
<p><strong>Example Architecture</strong>:</p>
<pre><code>API Gateway (HTTP)
  ↓
  → Backend Service (gRPC)
      ↓
      → PostgreSQL (SQL)
      → Redis (cache)
      → Kafka (events)

All instrumented by OBI with zero code changes
</code></pre>
<p><strong>Trace Visualization</strong>:</p>
<pre><code>Span 1: HTTP POST /api/orders [200ms]
  Span 2: gRPC OrderService.Create [180ms]
    Span 3: SQL INSERT INTO orders [50ms]
    Span 4: Redis SET order:123 [5ms]
    Span 5: Kafka SEND order.created [10ms]
</code></pre>
<h3 id="3-cost-optimization-with-adaptive-sampling">3. Cost Optimization with Adaptive Sampling<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-cost-optimization-with-adaptive-sampling" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem</strong>: High-volume production systems generate millions of traces, resulting in expensive storage and processing costs</p>
<p><strong>Solution</strong>: Combine OBI with Alloy’s tail-based sampling for intelligent trace retention</p>
<p><strong>Strategy</strong>:</p>
<ol>
<li>OBI captures all traces at kernel level (no sampling)</li>
<li>Alloy gateway performs tail-based sampling</li>
<li>Keep 100% of errors and slow requests</li>
<li>Sample 10% of normal requests</li>
</ol>
<p><strong>Configuration</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="hcl" data-theme="github-light one-dark-pro"><code data-language="hcl" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processor</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tail_sampling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;cost_optimized&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Decision wait time (buffer traces)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  decision_wait</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;10s&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  policies</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // Keep all errors (100%)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;errors&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;status_code&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      status_code {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        status_codes</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;ERROR&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // Keep slow requests > 1s (100%)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;slow_requests&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;latency&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      latency {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        threshold_ms</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 1000</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // Sample 10% of normal requests</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;sample_normal&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;probabilistic&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      probabilistic {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        sampling_percentage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> 10</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Cost Savings</strong>:</p>
<ul>
<li><strong>Before</strong>: 1M traces/day → $5,000/month storage</li>
<li><strong>After</strong>: 100K traces/day (90% reduction) → $500/month storage</li>
<li><strong>Result</strong>: 90% cost reduction with 100% error visibility</li>
</ul>
<h3 id="4-multi-tenancy-with-dynamic-routing">4. Multi-Tenancy with Dynamic Routing<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#4-multi-tenancy-with-dynamic-routing" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem</strong>: SaaS platform with multiple tenants requires isolated telemetry pipelines</p>
<p><strong>Solution</strong>: Alloy routing connector dynamically routes traces based on tenant ID</p>
<p><strong>Architecture</strong>:</p>
<pre><code>OBI (all tenants)
  ↓
Alloy Gateway (routing by tenant_id)
  ├─ Tenant A → Tempo A
  ├─ Tenant B → Tempo B
  └─ Tenant C → Tempo C
</code></pre>
<p><strong>Configuration</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="hcl" data-theme="github-light one-dark-pro"><code data-language="hcl" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Add tenant ID from K8s namespace</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processor</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">resource</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;add_tenant&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  attributes</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      key</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tenant_id&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      from_attribute</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;k8s.namespace.name&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      action</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;insert&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  output {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    traces</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [otelcol.connector.routing.tenants.input]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Route by tenant</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">connector</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">routing</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tenants&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  from_attribute</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tenant_id&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  attribute_source</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;resource&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  table</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tenant-a&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      pipelines</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;traces/tenant_a&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    },</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      value</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tenant-b&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      pipelines</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;traces/tenant_b&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  default_pipelines</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;traces/default&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Tenant isolation (no data mixing)</li>
<li>Per-tenant sampling policies</li>
<li>Independent backend scaling</li>
<li>Compliance (data residency requirements)</li>
</ul>
<h3 id="5-performance-benchmarking--ab-testing">5. Performance Benchmarking &amp; A/B Testing<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#5-performance-benchmarking--ab-testing" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Problem</strong>: Need to measure performance impact of code changes or infrastructure updates</p>
<p><strong>Solution</strong>: Use OBI’s minimal overhead for unbiased performance measurement</p>
<p><strong>Scenario</strong>: A/B test new database connection pool</p>
<p><strong>Setup</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Version A: Old connection pool (10 connections)</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">apps/v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Deployment</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">api-v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  labels</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    version</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  template</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      labels</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        version</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">v1</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#ABB2BF;">---</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Version B: New connection pool (50 connections)</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">apps/v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Deployment</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">api-v2</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  labels</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    version</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">v2</span></span></code></pre></figure>
<p><strong>Analysis with OBI + Grafana</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light one-dark-pro"><code data-language="sql" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- TraceQL query in Tempo</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  resource</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">service</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;api&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">resource</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">version</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;v1&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  &amp;&amp; duration </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">></span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 100ms</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  resource</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">service</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;api&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">resource</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">version</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;v2&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  &amp;&amp; duration </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">></span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 100ms</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Results Dashboard</strong>:</p>
<pre><code>Version A (v1):
  - p50: 150ms
  - p95: 500ms
  - p99: 1200ms
  - Error rate: 0.5%

Version B (v2):
  - p50: 80ms (47% improvement)
  - p95: 250ms (50% improvement)
  - p99: 600ms (50% improvement)
  - Error rate: 0.2%

Winner: Version B (rollout to 100%)
</code></pre>
<p><strong>Why OBI is Ideal</strong>:</p>
<ul>
<li>Zero instrumentation overhead (&lt; 1% CPU)</li>
<li>Consistent measurement across versions</li>
<li>No SDK version differences</li>
<li>Captures infrastructure-level details</li>
</ul>
<hr/>
<h2 id="experimental-implementations">Experimental Implementations<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#experimental-implementations" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="experiment-1-adaptive-tail-based-sampling-with-slo-integration">Experiment 1: Adaptive Tail-Based Sampling with SLO Integration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#experiment-1-adaptive-tail-based-sampling-with-slo-integration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Objective</strong>: Dynamically adjust sampling rates based on SLO breaches</p>
<p><strong>Concept</strong>: Increase sampling when p95 latency exceeds SLO to capture more debug data</p>
<p><strong>Architecture</strong>:</p>
<pre><code>Mimir (metrics)
  ↓ Alert when p95 > SLO
Alertmanager
  ↓ Webhook
Custom Controller
  ↓ Update ConfigMap
Alloy (reloads config)
  ↓ Increase sampling rate
Tempo (captures more traces)
</code></pre>
<p><strong>Implementation</strong>:</p>
<p><strong>Step 1</strong>: Prometheus rule for SLO breach</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">monitoring.coreos.com/v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">PrometheusRule</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">slo-latency-breach</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  groups</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">slo</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    rules</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">alert</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">HighLatency</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      expr</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        histogram_quantile(0.95,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          rate(http_server_duration_seconds_bucket[5m])</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        ) > 1.0  # SLO: p95 &lt; 1s</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      for</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">5m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      annotations</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        summary</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;p95 latency exceeds SLO&quot;</span></span></code></pre></figure>
<p><strong>Step 2</strong>: Webhook receiver adjusts sampling</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="go" data-theme="github-light one-dark-pro"><code data-language="go" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Custom controller</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> handleSLOBreach</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">w</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;"> http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">ResponseWriter</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> *</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#E5C07B;">Request</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">) {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // Increase sampling from 10% to 50%</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">    updateAlloyConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sampling_percentage&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;50&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    // Auto-revert after 30 minutes</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">AfterFunc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">Minute</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">func</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">() {</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">        updateAlloyConfig</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;sampling_percentage&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;10&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    })</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Step 3</strong>: Alloy config with variable sampling</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="hcl" data-theme="github-light one-dark-pro"><code data-language="hcl" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processor</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">tail_sampling</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;adaptive&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  policies</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      name</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;sample&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;probabilistic&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      probabilistic {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        // Dynamically adjusted via ConfigMap</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        sampling_percentage</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> env</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;SAMPLING_PERCENTAGE&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Expected Results</strong>:</p>
<ul>
<li><strong>Normal operation</strong>: 10% sampling, low cost</li>
<li><strong>SLO breach</strong>: 50% sampling for 30 minutes, capture debug data</li>
<li><strong>Cost impact</strong>: Temporary 5x increase, acceptable for troubleshooting</li>
</ul>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Automatic response to issues</li>
<li>Captures detailed traces when needed most</li>
<li>Cost-efficient during normal operation</li>
</ul>
<h3 id="experiment-2-network-level-service-dependency-discovery">Experiment 2: Network-Level Service Dependency Discovery<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#experiment-2-network-level-service-dependency-discovery" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Objective</strong>: Automatically discover service dependencies from network traffic (no APM required)</p>
<p><strong>Concept</strong>: OBI captures network-level HTTP calls, build service graph automatically</p>
<p><strong>Architecture</strong>:</p>
<pre><code>OBI DaemonSet
  ↓ Captures all HTTP calls
  ↓ source_service → destination_service
Alloy
  ↓ Aggregates calls into service graph
Tempo
  ↓ Stores dependency data
Grafana
  ↓ Visualizes service graph
</code></pre>
<p><strong>Implementation</strong>:</p>
<p><strong>Step 1</strong>: OBI captures network calls</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># OBI auto-discovers all HTTP traffic</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># No configuration needed - kernel-level capture</span></span></code></pre></figure>
<p><strong>Step 2</strong>: Alloy extracts service relationships</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="hcl" data-theme="github-light one-dark-pro"><code data-language="hcl" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processor</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">servicegraph</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;dependencies&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Build service graph from spans</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  latency_histogram_buckets</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  dimensions</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;service&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http.method&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http.status_code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">]</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  output {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    metrics</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [otelcol.exporter.prometheus.mimir.input]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Step 3</strong>: Query service graph</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="promql" data-theme="github-light one-dark-pro"><code data-language="promql" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span># Outbound calls from api service</span></span>
<span data-line><span>sum by (service, destination_service) (</span></span>
<span data-line><span>  rate(traces_service_graph_calls_total{service=&quot;api&quot;}[5m])</span></span>
<span data-line><span>)</span></span>
<span data-line> </span>
<span data-line><span># Result:</span></span>
<span data-line><span>api → user-service: 100 req/s</span></span>
<span data-line><span>api → payment-service: 50 req/s</span></span>
<span data-line><span>api → notification-service: 20 req/s</span></span></code></pre></figure>
<p><strong>Step 4</strong>: Grafana visualization</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="json" data-theme="github-light one-dark-pro"><code data-language="json" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;nodeGraph&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;datasource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Mimir&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;targets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">      &quot;expr&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;traces_service_graph_calls_total&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Expected Results</strong>:</p>
<ul>
<li>Automatic service dependency map</li>
<li>No code instrumentation required</li>
<li>Real-time updates as topology changes</li>
<li>Historical dependency tracking</li>
</ul>
<p><strong>Use Cases</strong>:</p>
<ul>
<li>Migration planning (identify dependencies before decommissioning)</li>
<li>Blast radius analysis (what services depend on X?)</li>
<li>Architecture documentation (auto-generated diagrams)</li>
</ul>
<h3 id="experiment-3-database-query-performance-profiling">Experiment 3: Database Query Performance Profiling<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#experiment-3-database-query-performance-profiling" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Objective</strong>: Identify slow SQL queries without database instrumentation</p>
<p><strong>Concept</strong>: OBI captures SQL queries at protocol level, analyze performance patterns</p>
<p><strong>Architecture</strong>:</p>
<pre><code>Application (uninstrumented)
  ↓
PostgreSQL (uninstrumented)
  ↑ (SQL traffic captured by OBI eBPF)
OBI DaemonSet
  ↓ SQL spans with query + duration
Tempo
  ↓
Grafana (query analysis)
</code></pre>
<p><strong>Implementation</strong>:</p>
<p><strong>Step 1</strong>: Enable SQL instrumentation in OBI</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ConfigMap</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-config</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  config.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    instrumentation:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      sql:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        enabled: true</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        # Security: sanitize queries (remove literals)</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        sanitize_queries: true</span></span></code></pre></figure>
<p><strong>Step 2</strong>: Query slow SQL spans in Tempo</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="sql" data-theme="github-light one-dark-pro"><code data-language="sql" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">-- TraceQL: Find slow SQL queries</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  span</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">kind</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;client&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  &amp;&amp; </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">span</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">db</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">system</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;postgresql&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  &amp;&amp; duration </span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;">></span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> 1s</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">group by</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> span</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">db</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">statement</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">| </span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">count</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">()</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">| sort </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">by</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> count </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">desc</span></span></code></pre></figure>
<p><strong>Step 3</strong>: Grafana dashboard for SQL analysis</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="json" data-theme="github-light one-dark-pro"><code data-language="json" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">{</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">  &quot;panels&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">      &quot;title&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Slowest SQL Queries (p95)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">      &quot;targets&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        {</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">          &quot;datasource&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;Tempo&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">          &quot;query&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;{span.db.system=</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">postgresql</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;">\&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">}&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      ],</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">      &quot;transformations&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        {</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">          &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;groupBy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">          &quot;options&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">            &quot;fields&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">              &quot;db.statement&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&quot;operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;groupby&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> },</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">              &quot;duration&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: { </span><span style="--shiki-light:#005CC5;--shiki-dark:#E06C75;">&quot;operation&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;p95&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">            }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">          }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Expected Results</strong>:</p>
<pre><code>Top Slow Queries:
1. SELECT * FROM orders WHERE status = ? (p95: 2.5s, count: 1000)
2. SELECT * FROM products JOIN categories ... (p95: 1.8s, count: 500)
3. UPDATE inventory SET quantity = ? ... (p95: 1.2s, count: 300)
</code></pre>
<p><strong>Optimization Actions</strong>:</p>
<ul>
<li>Query 1: Add index on <code>orders.status</code></li>
<li>Query 2: Optimize join with covering index</li>
<li>Query 3: Batch updates to reduce transactions</li>
</ul>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Zero database instrumentation</li>
<li>Identifies N+1 queries automatically</li>
<li>Correlates slow queries with application traces</li>
<li>Security-conscious (sanitized queries)</li>
</ul>
<h3 id="experiment-4-cost-optimized-multi-region-observability">Experiment 4: Cost-Optimized Multi-Region Observability<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#experiment-4-cost-optimized-multi-region-observability" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Objective</strong>: Reduce cross-region data transfer costs for global deployments</p>
<p><strong>Concept</strong>: Deploy regional Tempo instances, replicate only aggregated metrics centrally</p>
<p><strong>Architecture</strong>:</p>
<pre><code>Region US-East:
  OBI → Alloy → Tempo (local)
            ↓ Aggregated metrics
Region EU-West:          ↓
  OBI → Alloy → Tempo (local) → Mimir (central)
            ↓ Aggregated metrics ↑
Region AP-South:         ↑
  OBI → Alloy → Tempo (local) ─┘
</code></pre>
<p><strong>Implementation</strong>:</p>
<p><strong>Step 1</strong>: Regional Tempo deployments</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># US-East Tempo</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ConfigMap</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">tempo-us-east</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  tempo.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    storage:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      trace:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        backend: s3</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        s3:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          bucket: tempo-us-east</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          region: us-east-1</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#ABB2BF;">---</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># EU-West Tempo</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">v1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">ConfigMap</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">tempo-eu-west</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  tempo.yaml</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    storage:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      trace:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        backend: s3</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        s3:</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          bucket: tempo-eu-west</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          region: eu-west-1</span></span></code></pre></figure>
<p><strong>Step 2</strong>: Regional Alloy with metric aggregation</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="hcl" data-theme="github-light one-dark-pro"><code data-language="hcl" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Regional Alloy configuration</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">receiver</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">otlp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;obi&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  grpc { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;0.0.0.0:4317&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  output {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    traces</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // Keep traces local (Tempo regional)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      otelcol.exporter.otlp.tempo_local.input,</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">      // Send aggregated metrics to central Mimir</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      otelcol.processor.metricstransform.aggregate.input</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Local Tempo (no cross-region egress)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exporter</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">otlp</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tempo_local&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  client {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    endpoint</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;tempo.local:4317&quot;</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Same region</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Aggregate and send metrics centrally</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">processor</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">metricstransform</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aggregate&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // Aggregate to RED metrics only</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  transforms</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      include</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;.*&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      match_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;regexp&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      action</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;aggregate&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">      aggregation</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">        aggregation_type</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;histogram&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  ]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  output {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    metrics</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> [otelcol.exporter.prometheusremotewrite.central.input]</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">// Central Mimir (cross-region, low bandwidth)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">otelcol</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">exporter</span><span style="--shiki-light:#D73A49;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">prometheusremotewrite</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;central&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  endpoint {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">    url</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> &quot;https://mimir-central.global/api/v1/push&quot;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  }</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span></code></pre></figure>
<p><strong>Cost Analysis</strong>:</p>
<p><strong>Scenario</strong>: 1TB traces/month per region, 3 regions</p>
<p><strong>Option A: Centralized (naive)</strong></p>
<ul>
<li>Cross-region transfer: 3TB x <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.09/</span><span class="mord mathnormal" style="margin-right:0.05017em;">GB</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>270/month</li>
<li>Storage: 3TB x <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.023/</span><span class="mord mathnormal" style="margin-right:0.05017em;">GB</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>69/month</li>
<li><strong>Total</strong>: $339/month</li>
</ul>
<p><strong>Option B: Regional with aggregated metrics</strong></p>
<ul>
<li>Cross-region transfer: 10GB (metrics only) x <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.09/</span><span class="mord mathnormal" style="margin-right:0.05017em;">GB</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>0.90/month</li>
<li>Regional storage: 3 x 1TB x <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">0.023/</span><span class="mord mathnormal" style="margin-right:0.05017em;">GB</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span></span></span></span>69/month</li>
<li><strong>Total</strong>: $69.90/month</li>
</ul>
<p><strong>Savings</strong>: <strong>$269.10/month (79% reduction)</strong></p>
<p><strong>Trade-offs</strong>:</p>
<ul>
<li>Traces stay regional (need VPN for cross-region query)</li>
<li>Metrics available globally (RED metrics, SLO monitoring)</li>
<li>Acceptable for most use cases (errors/latency visible globally)</li>
</ul>
<h3 id="experiment-5-canary-deployment-automated-rollback">Experiment 5: Canary Deployment Automated Rollback<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#experiment-5-canary-deployment-automated-rollback" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Objective</strong>: Automatically rollback canary deployments based on OBI telemetry</p>
<p><strong>Concept</strong>: Compare error rates and latency between stable and canary versions, rollback if canary degrades</p>
<p><strong>Architecture</strong>:</p>
<pre><code>OBI (captures both versions)
  ↓
Alloy (routes by version label)
  ↓
Tempo + Mimir
  ↓ Metrics comparison
Argo Rollouts (progressive delivery)
  ↓ Automated rollback decision
</code></pre>
<p><strong>Implementation</strong>:</p>
<p><strong>Step 1</strong>: Argo Rollouts canary deployment</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">argoproj.io/v1alpha1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Rollout</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">api-service</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    canary</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      steps</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">setWeight</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # 10% traffic to canary</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">pause</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">5m</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}  </span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Collect metrics</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">setWeight</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">50</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">pause</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: {</span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">duration</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">5m</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">}</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">setWeight</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">100</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      analysis</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        templates</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">templateName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-error-rate</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">        - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">templateName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-latency-p95</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        startingStep</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Start after 10% traffic</span></span></code></pre></figure>
<p><strong>Step 2</strong>: Analysis templates (query OBI metrics)</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">argoproj.io/v1alpha1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">AnalysisTemplate</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-error-rate</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  metrics</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">error-rate</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    interval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    successCondition</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">result &lt; 0.05</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # &lt; 5% errors</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    failureLimit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    provider</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">http://mimir:9009</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        query</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          sum(rate(http_server_request_total{</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            service=&quot;api-service&quot;,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            version=&quot;{{args.canary-hash}}&quot;,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            status=~&quot;5..&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          }[5m]))</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          /</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          sum(rate(http_server_request_total{</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            service=&quot;api-service&quot;,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            version=&quot;{{args.canary-hash}}&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          }[5m]))</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#ABB2BF;">---</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">argoproj.io/v1alpha1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">AnalysisTemplate</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">obi-latency-p95</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  metrics</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">  - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">latency-p95</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    interval</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    successCondition</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">result &lt; 1.0</span><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # p95 &lt; 1s</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    failureLimit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    provider</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      prometheus</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        address</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">http://mimir:9009</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        query</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          histogram_quantile(0.95,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            rate(http_server_duration_seconds_bucket{</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              service=&quot;api-service&quot;,</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">              version=&quot;{{args.canary-hash}}&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            }[5m])</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          )</span></span></code></pre></figure>
<p><strong>Step 3</strong>: Automated rollback flow</p>
<pre><code>1. Deploy canary (10% traffic)
   ↓
2. OBI captures metrics for 5 minutes
   ↓
3. Argo Rollouts queries Mimir:
   - Canary error rate: 8% (FAIL)
   - Stable error rate: 2%
   ↓
4. Analysis fails → Automatic rollback
   ↓
5. Alert sent to team
</code></pre>
<p><strong>Expected Results</strong>:</p>
<ul>
<li>Automated quality gates based on OBI telemetry</li>
<li>Zero-code instrumentation (OBI) enables safe deployments</li>
<li>Faster rollout cycles (confidence in automated rollback)</li>
<li>Reduced MTTR (mean time to recovery)</li>
</ul>
<p><strong>Benefits</strong>:</p>
<ul>
<li>Progressive delivery with telemetry validation</li>
<li>No manual intervention for rollbacks</li>
<li>Works with any language (OBI is language-agnostic)</li>
<li>Historical comparison (canary vs stable)</li>
</ul>
<hr/>
<h2 id="helm-charts--kubernetes">Helm Charts &amp; Kubernetes<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#helm-charts--kubernetes" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="official-helm-charts">Official Helm Charts<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#official-helm-charts" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="1-opentelemetry-ebpf-helm-chart">1. OpenTelemetry eBPF Helm Chart<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-opentelemetry-ebpf-helm-chart" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Repository</strong>: <a href="https://artifacthub.io/packages/helm/opentelemetry-helm/opentelemetry-ebpf" class="external">https://artifacthub.io/packages/helm/opentelemetry-helm/opentelemetry-ebpf<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p><strong>Installation</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Add OpenTelemetry Helm repo</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> opentelemetry-helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://open-telemetry.github.io/opentelemetry-helm-charts</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Install OBI</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> obi</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> opentelemetry-helm/opentelemetry-ebpf</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> daemonset.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config.otelExporterOtlpEndpoint=&quot;http://alloy-gateway:4317&quot;</span></span></code></pre></figure>
<p><strong>Key Configuration Options</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># values.yaml</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">daemonset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  hostNetwork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  hostPID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # OTLP export endpoint</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  otelExporterOtlpEndpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://alloy-gateway:4317&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Ports to instrument</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  openPorts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8080,8443,9090&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Services to instrument (regex)</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  serviceNamespace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;production&quot;</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # Protocol-specific settings</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  instrumentation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    grpc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    sql</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      sanitizeQueries</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    redis</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    kafka</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">securityContext</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  privileged</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  capabilities</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    add</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">SYS_ADMIN</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">SYS_PTRACE</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">NET_ADMIN</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">BPF</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">resources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  requests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">100m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">128Mi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  limits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">500m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">512Mi</span></span></code></pre></figure>
<h4 id="2-grafana-alloy-operator-helm-chart">2. Grafana Alloy Operator Helm Chart<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-grafana-alloy-operator-helm-chart" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Repository</strong>: <a href="https://github.com/grafana/alloy-operator" class="external">https://github.com/grafana/alloy-operator<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p><strong>Installation</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Add Grafana Helm repo</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://grafana.github.io/helm-charts</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Install Alloy Operator</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy-operator</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana/alloy-operator</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy-system</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span></span></code></pre></figure>
<p><strong>Deploy Alloy Instance</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">apiVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">alloy.grafana.com/v1alpha1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">kind</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Alloy</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">metadata</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">alloy-gateway</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  namespace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">observability</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">spec</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  mode</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">statefulset</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  clustering</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    // Full Alloy River configuration here</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    otelcol.receiver.otlp &quot;obi&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      grpc { endpoint = &quot;0.0.0.0:4317&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      http { endpoint = &quot;0.0.0.0:4318&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        traces = [otelcol.processor.batch.default.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    }</span></span></code></pre></figure>
<h4 id="3-grafana-lgtm-stack-helm-chart">3. Grafana LGTM Stack Helm Chart<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-grafana-lgtm-stack-helm-chart" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Repository</strong>: <a href="https://github.com/grafana/lgtm-stack" class="external">https://github.com/grafana/lgtm-stack<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></p>
<p><strong>Installation</strong> (All-in-one):</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Install complete LGTM stack</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://grafana.github.io/helm-charts</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lgtm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana/lgtm-stack</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tempo.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mimir.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loki.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span></code></pre></figure>
<p><strong>Key Components</strong>:</p>
<ul>
<li>Alloy (telemetry pipeline)</li>
<li>Tempo (traces)</li>
<li>Mimir (metrics)</li>
<li>Loki (logs)</li>
<li>Grafana (visualization)</li>
</ul>
<h3 id="complete-obi--lgtm-deployment">Complete OBI + LGTM Deployment<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#complete-obi--lgtm-deployment" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>values.yaml</strong> (combined):</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="yaml" data-theme="github-light one-dark-pro"><code data-language="yaml" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># OBI DaemonSet</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">obi</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  daemonset</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    hostNetwork</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    hostPID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    otelExporterOtlpEndpoint</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;http://alloy-gateway:4317&quot;</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    openPorts</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&quot;8080,8443,9090&quot;</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    instrumentation</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      http</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      grpc</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      sql</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      redis</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      kafka</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    requests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">100m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">128Mi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    limits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">500m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">512Mi</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Alloy Gateway</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">alloy</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  controller</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">statefulset</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  clustering</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  config</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    content</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">|</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      // OTLP receiver from OBI</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      otelcol.receiver.otlp &quot;obi&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        grpc { endpoint = &quot;0.0.0.0:4317&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        http { endpoint = &quot;0.0.0.0:4318&quot; }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          traces = [otelcol.processor.batch.default.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          metrics = [otelcol.processor.batch.default.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      // Batch processing</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      otelcol.processor.batch &quot;default&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        send_batch_size = 1024</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        timeout = 10s</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          traces = [otelcol.processor.tail_sampling.cost_optimized.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          metrics = [otelcol.exporter.prometheus.mimir.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      // Tail-based sampling (cost optimization)</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      otelcol.processor.tail_sampling &quot;cost_optimized&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        decision_wait = &quot;10s&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        policies = [</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            name = &quot;errors&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            type = &quot;status_code&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            status_code { status_codes = [&quot;ERROR&quot;] }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          },</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            name = &quot;slow&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            type = &quot;latency&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            latency { threshold_ms = 1000 }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          },</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            name = &quot;sample&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            type = &quot;probabilistic&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            probabilistic { sampling_percentage = 10 }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        ]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        output {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          traces = [otelcol.exporter.otlp.tempo.input]</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      // Export to Tempo</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      otelcol.exporter.otlp &quot;tempo&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        client {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          endpoint = &quot;tempo-distributor:4317&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          tls { insecure = true }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      // Export to Mimir</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      otelcol.exporter.prometheus &quot;mimir&quot; {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        endpoint {</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          url = &quot;http://mimir-distributor:9009/api/v1/push&quot;</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">        }</span></span>
<span data-line><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">      }</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    requests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">500m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1Gi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    limits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2000m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">4Gi</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Tempo (traces)</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">tempo</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  storage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    trace</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      backend</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">s3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      s3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        bucket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">tempo-traces</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        region</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">us-east-1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    requests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">500m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1Gi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    limits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2000m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">4Gi</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Mimir (metrics)</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">mimir</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  storage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    backend</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">s3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    s3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      bucket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">mimir-metrics</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      region</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">us-east-1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    requests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1000m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2Gi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    limits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">4000m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">8Gi</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Loki (logs)</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">loki</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  storage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    backend</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">s3</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    s3</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      bucket</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">loki-logs</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      region</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">us-east-1</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    requests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">500m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1Gi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    limits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2000m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">4Gi</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Grafana (visualization)</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">grafana</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  replicas</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">2</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  datasources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Tempo</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">tempo</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">http://tempo-query-frontend:3100</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      isDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Mimir</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">prometheus</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">http://mimir-query-frontend:8080/prometheus</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      isDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">    - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Loki</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">loki</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      url</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">http://loki-query-frontend:3100</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      isDefault</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  dashboards</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    enabled</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    providers</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">      - </span><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">default</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        folder</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">Observability</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">file</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        disableDeletion</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">false</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        editable</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">        options</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">          path</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">/var/lib/grafana/dashboards</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">  resources</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    requests</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">250m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">512Mi</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">    limits</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">:</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      cpu</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">1000m</span></span>
<span data-line><span style="--shiki-light:#22863A;--shiki-dark:#E06C75;">      memory</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">2Gi</span></span></code></pre></figure>
<p><strong>Deploy Complete Stack</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Install OBI + LGTM stack</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> .</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --values</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> values.yaml</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --timeout</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 15m</span></span></code></pre></figure>
<p><strong>Verify Deployment</strong>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Check all pods</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> pods</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Expected output:</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">NAME</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                                READY</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   STATUS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">    RESTARTS</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">   AGE</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">obi-agent-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">obi-agent-yyyyy</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloy-gateway-0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloy-gateway-1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">alloy-gateway-2</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tempo-distributor-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tempo-ingester-0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">tempo-query-frontend-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mimir-distributor-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">            1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mimir-ingester-0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                   1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">mimir-query-frontend-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">         1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">loki-distributor-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">             1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">loki-ingester-0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                    1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">loki-query-frontend-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">grafana-xxxxx</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">                      1/1</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">     Running</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">   0</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">          2m</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Test OBI instrumentation</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> port-forward</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> svc/grafana</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3000:80</span></span>
<span data-line> </span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Open browser: http://localhost:3000</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Login: admin / (check secret)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Navigate to Explore → Tempo → Search for traces</span></span></code></pre></figure>
<hr/>
<h2 id="comparison-with-traditional-backends">Comparison with Traditional Backends<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#comparison-with-traditional-backends" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="traditional-apm-approach">Traditional APM Approach<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#traditional-apm-approach" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Architecture</strong>:</p>
<pre><code>Application
  ↓ (SDK embedded in process)
OpenTelemetry SDK
  ↓ (in-process sampling)
OTLP Exporter
  ↓
Collector / Backend
</code></pre>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><strong>Installation</strong>: Add SDK to each application (dependency)</li>
<li><strong>Language Support</strong>: Per-language SDKs (Java, Python, Go, etc.)</li>
<li><strong>Performance Impact</strong>: 5-15% CPU, high memory (GC pressure)</li>
<li><strong>Instrumentation</strong>: Manual (code changes) or auto-instrumentation (agent)</li>
<li><strong>Custom Attributes</strong>: Full support for application-specific metadata</li>
<li><strong>Protocol Coverage</strong>: Library-dependent (HTTP, gRPC, DB drivers)</li>
<li><strong>Deployment</strong>: Per-application (SDK + config in each service)</li>
</ul>
<h3 id="obi-approach">OBI Approach<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#obi-approach" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Architecture</strong>:</p>
<pre><code>Application (unmodified)
  ↓
Linux Kernel
  ↓ (eBPF probes)
OBI Agent (DaemonSet)
  ↓
Collector / Backend
</code></pre>
<p><strong>Characteristics</strong>:</p>
<ul>
<li><strong>Installation</strong>: Deploy DaemonSet (no application changes)</li>
<li><strong>Language Support</strong>: Universal (kernel-level, language-agnostic)</li>
<li><strong>Performance Impact</strong>: &lt; 1% CPU, minimal memory (kernel-space)</li>
<li><strong>Instrumentation</strong>: Zero-code (automatic protocol detection)</li>
<li><strong>Custom Attributes</strong>: Limited (protocol-level data only)</li>
<li><strong>Protocol Coverage</strong>: Protocol-level (HTTP, gRPC, SQL, Redis, Kafka)</li>
<li><strong>Deployment</strong>: Centralized (one DaemonSet per node)</li>
</ul>
<h3 id="detailed-comparison-table">Detailed Comparison Table<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#detailed-comparison-table" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>




































































































<div class="table-container"><table><thead><tr><th>Aspect</th><th>Traditional SDK/APM</th><th>OBI (eBPF)</th></tr></thead><tbody><tr><td><strong>Installation Complexity</strong></td><td>High (per-service)</td><td>Low (DaemonSet)</td></tr><tr><td><strong>Code Changes Required</strong></td><td>Yes (import SDK)</td><td>No</td></tr><tr><td><strong>Application Restart</strong></td><td>Yes</td><td>No</td></tr><tr><td><strong>Language Coverage</strong></td><td>Per-language SDKs</td><td>Universal (any language)</td></tr><tr><td><strong>Runtime Version Support</strong></td><td>Limited (recent versions)</td><td>Universal (Java 8, Python 2.7, etc.)</td></tr><tr><td><strong>CPU Overhead</strong></td><td>5-15%</td><td>&lt; 1%</td></tr><tr><td><strong>Memory Overhead</strong></td><td>50-200MB per service</td><td>50-100MB per node</td></tr><tr><td><strong>Latency Impact</strong></td><td>1-5ms per request</td><td>0ms (kernel-level)</td></tr><tr><td><strong>Custom Attributes</strong></td><td>Full support</td><td>Limited (protocol-level)</td></tr><tr><td><strong>Business Logic Tracing</strong></td><td>Yes (spans within methods)</td><td>No (HTTP/RPC boundaries only)</td></tr><tr><td><strong>Protocol Support</strong></td><td>Library-dependent</td><td>Protocol-level (HTTP, gRPC, SQL, etc.)</td></tr><tr><td><strong>Sampling Control</strong></td><td>In-process (head-based)</td><td>External (tail-based supported)</td></tr><tr><td><strong>Deployment Model</strong></td><td>Distributed (per-app)</td><td>Centralized (per-node)</td></tr><tr><td><strong>Maintenance Overhead</strong></td><td>High (update each service)</td><td>Low (update DaemonSet)</td></tr><tr><td><strong>Legacy Application Support</strong></td><td>Poor (no SDK for old runtimes)</td><td>Excellent (kernel-level)</td></tr><tr><td><strong>Security</strong></td><td>SDK vulnerabilities</td><td>Kernel-level isolation</td></tr><tr><td><strong>Vendor Lock-in</strong></td><td>Possible (proprietary SDKs)</td><td>None (OpenTelemetry standard)</td></tr><tr><td><strong>Cost</strong></td><td>High (per-app overhead)</td><td>Low (shared per-node)</td></tr></tbody></table></div>
<h3 id="when-to-use-each-approach">When to Use Each Approach<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#when-to-use-each-approach" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="use-traditional-sdk-when">Use Traditional SDK When:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#use-traditional-sdk-when" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ol>
<li><strong>Deep Application Insights Needed</strong>: Custom spans, business-logic tracing, detailed context</li>
<li><strong>Supported Runtime</strong>: Modern language versions with good SDK support</li>
<li><strong>Full Control</strong>: Team wants fine-grained sampling and attribute control</li>
<li><strong>Greenfield Projects</strong>: New applications being built from scratch</li>
<li><strong>Performance Acceptable</strong>: 5-15% overhead is acceptable trade-off</li>
</ol>
<p><strong>Example</strong>: New microservice architecture, modern stack (Java 21, Python 3.12, Go 1.22)</p>
<h4 id="use-obi-when">Use OBI When:<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#use-obi-when" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ol>
<li><strong>Zero-Code Requirement</strong>: Cannot modify application code or add dependencies</li>
<li><strong>Legacy Applications</strong>: Old runtimes without SDK support (Java 8, Python 2.7)</li>
<li><strong>Minimal Overhead Critical</strong>: High-performance applications where 5% CPU matters</li>
<li><strong>Brownfield Projects</strong>: Existing applications without instrumentation</li>
<li><strong>Universal Coverage</strong>: Consistent telemetry across many languages</li>
<li><strong>Cost Optimization</strong>: Minimize per-service overhead</li>
</ol>
<p><strong>Example</strong>: Legacy monolith migration, multi-language microservices, cost-sensitive SaaS platform</p>
<h4 id="hybrid-approach-recommended">Hybrid Approach (Recommended):<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#hybrid-approach-recommended" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Combine Both</strong> for complementary coverage:</p>
<ul>
<li><strong>OBI</strong>: Protocol-level RED metrics and distributed tracing (universal, zero-code)</li>
<li><strong>Traditional SDK</strong>: Application-specific custom spans and attributes (selective, high-value services)</li>
</ul>
<p><strong>Example Architecture</strong>:</p>
<pre><code>API Gateway (OBI only)
  ↓
Auth Service (OBI + SDK)
  - OBI: HTTP/gRPC/SQL spans
  - SDK: Custom spans (token validation, user lookup)
  ↓
User Service (OBI + SDK)
  - OBI: HTTP/Redis/SQL spans
  - SDK: Business logic spans (user profile enrichment)
  ↓
Legacy Service (OBI only)
  - OBI: HTTP/SQL spans
  - No SDK (Java 8, cannot modify)
</code></pre>
<p><strong>Benefits of Hybrid</strong>:</p>
<ul>
<li>Universal coverage (OBI ensures every service is observable)</li>
<li>Deep insights where needed (SDK for critical paths)</li>
<li>Cost-optimized (SDK overhead only for high-value services)</li>
<li>Gradual migration (add SDK incrementally)</li>
</ul>
<hr/>
<h2 id="recommendations">Recommendations<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#recommendations" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="quick-start-path">Quick Start Path<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#quick-start-path" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p><strong>Goal</strong>: Get OBI + LGTM stack running in under 30 minutes</p>
<p><strong>Prerequisites</strong>:</p>
<ul>
<li>Kubernetes cluster (v1.24+)</li>
<li>kubectl configured</li>
<li>Helm 3 installed</li>
<li>4 CPU, 8GB RAM minimum</li>
</ul>
<p><strong>Steps</strong>:</p>
<ol>
<li><strong>Install Alloy Operator</strong> (5 minutes)</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://grafana.github.io/helm-charts</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> update</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy-operator</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana/alloy-operator</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> alloy-system</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span></span></code></pre></figure>
<ol start="2">
<li><strong>Install LGTM Stack</strong> (10 minutes)</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> lgtm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana/lgtm-stack</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --create-namespace</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> tempo.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> mimir.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> loki.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> grafana.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span></span></code></pre></figure>
<ol start="3">
<li><strong>Install OBI</strong> (5 minutes)</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> repo</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> add</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> opentelemetry-helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> https://open-telemetry.github.io/opentelemetry-helm-charts</span></span>
<span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">helm</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> obi</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> opentelemetry-helm/opentelemetry-ebpf</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --namespace</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> daemonset.enabled=</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">true</span><span style="--shiki-light:#005CC5;--shiki-dark:#56B6C2;"> \</span></span>
<span data-line><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">  --set</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> config.otelExporterOtlpEndpoint=&quot;http://lgtm-alloy:4317&quot;</span></span></code></pre></figure>
<ol start="4">
<li><strong>Access Grafana</strong> (1 minute)</li>
</ol>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="bash" data-theme="github-light one-dark-pro"><code data-language="bash" data-theme="github-light one-dark-pro" style="display:grid;"><span data-line><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">kubectl</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> port-forward</span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;"> -n</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> observability</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> svc/lgtm-grafana</span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;"> 3000:80</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Open: http://localhost:3000</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-light-font-style:inherit;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># Default credentials: admin / (get from secret)</span></span></code></pre></figure>
<ol start="5">
<li><strong>Verify Traces</strong> (1 minute)</li>
</ol>
<ul>
<li>Navigate to <strong>Explore</strong> → <strong>Tempo</strong></li>
<li>Search for traces (should see OBI-captured data)</li>
<li>View service graph automatically generated</li>
</ul>
<h3 id="production-readiness-checklist">Production Readiness Checklist<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#production-readiness-checklist" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="infrastructure">Infrastructure<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#infrastructure" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Kubernetes cluster with 3+ nodes (HA)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Object storage configured (S3, GCS, Azure Blob)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Persistent volumes for WAL (Alloy, Tempo, Mimir)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Network policies configured (isolation)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Resource quotas and limits defined</li>
</ul>
<h4 id="obi-configuration">OBI Configuration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#obi-configuration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> DaemonSet deployed on all nodes</li>
<li class="task-list-item"><input type="checkbox" disabled/> Security contexts configured (CAP_BPF, CAP_SYS_PTRACE)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Ports to instrument defined (8080, 8443, etc.)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Protocol instrumentation enabled (HTTP, gRPC, SQL, Redis, Kafka)</li>
<li class="task-list-item"><input type="checkbox" disabled/> OTLP endpoint configured (Alloy gateway)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Resource limits set (CPU: 500m, Memory: 512Mi per node)</li>
</ul>
<h4 id="alloy-configuration">Alloy Configuration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#alloy-configuration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> StatefulSet with 3+ replicas (HA)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Clustering enabled (load distribution)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Tail-based sampling configured (cost optimization)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Batch processing enabled (performance)</li>
<li class="task-list-item"><input type="checkbox" disabled/> OTLP receiver configured (from OBI)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Exporters configured (Tempo, Mimir)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Resource limits set (CPU: 2000m, Memory: 4Gi per replica)</li>
</ul>
<h4 id="tempo-configuration">Tempo Configuration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#tempo-configuration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Distributed mode (ingester, distributor, query-frontend)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Object storage backend configured (S3, GCS)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Retention policy configured (14-30 days recommended)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Compaction enabled (reduce storage costs)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Query frontend with caching (performance)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Multi-tenancy configured (if required)</li>
</ul>
<h4 id="mimir-configuration">Mimir Configuration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mimir-configuration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Distributed mode (ingester, distributor, query-frontend)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Object storage backend configured (S3, GCS)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Long-term retention (90+ days)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Compaction and downsampling enabled</li>
<li class="task-list-item"><input type="checkbox" disabled/> Query caching configured</li>
<li class="task-list-item"><input type="checkbox" disabled/> Alertmanager configured</li>
</ul>
<h4 id="grafana-configuration">Grafana Configuration<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#grafana-configuration" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Datasources configured (Tempo, Mimir, Loki)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Dashboards provisioned (RED metrics, service graph)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Alerts configured (SLO breaches, errors)</li>
<li class="task-list-item"><input type="checkbox" disabled/> RBAC configured (team access control)</li>
<li class="task-list-item"><input type="checkbox" disabled/> SSO/LDAP configured (if required)</li>
</ul>
<h4 id="monitoring--alerting">Monitoring &amp; Alerting<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#monitoring--alerting" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> OBI agent health checks (DaemonSet status)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Alloy pipeline metrics (throughput, errors)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Tempo ingestion rate and latency</li>
<li class="task-list-item"><input type="checkbox" disabled/> Mimir cardinality and query performance</li>
<li class="task-list-item"><input type="checkbox" disabled/> Grafana availability and dashboard load times</li>
<li class="task-list-item"><input type="checkbox" disabled/> Alerts for component failures</li>
</ul>
<h4 id="cost-optimization">Cost Optimization<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#cost-optimization" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled/> Tail-based sampling configured (10% baseline)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Object storage lifecycle policies (delete old data)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Regional deployments (reduce cross-region egress)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Metric cardinality limits (prevent explosion)</li>
<li class="task-list-item"><input type="checkbox" disabled/> Log aggregation rules (reduce log volume)</li>
</ul>
<h3 id="interesting-experiments-to-try">Interesting Experiments to Try<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#interesting-experiments-to-try" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="1-zero-code-migration-challenge">1. Zero-Code Migration Challenge<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#1-zero-code-migration-challenge" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Goal</strong>: Instrument 10+ microservices in under 1 hour without code changes</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Deploy OBI DaemonSet</li>
<li>Label services to instrument: <code>obi.instrument: &quot;true&quot;</code></li>
<li>Wait 5 minutes for telemetry to appear</li>
<li>Visualize service graph in Grafana</li>
</ol>
<p><strong>Success Criteria</strong>:</p>
<ul>
<li>All services show RED metrics</li>
<li>Distributed traces captured end-to-end</li>
<li>No application restarts or code changes</li>
</ul>
<h4 id="2-cost-optimization-challenge">2. Cost Optimization Challenge<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#2-cost-optimization-challenge" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Goal</strong>: Reduce observability costs by 80% while maintaining error visibility</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Measure baseline: 1M traces/day = $5,000/month</li>
<li>Implement tail-based sampling:
<ul>
<li>100% errors</li>
<li>100% slow requests (> 1s)</li>
<li>10% normal requests</li>
</ul>
</li>
<li>Measure new cost: 200K traces/day = $1,000/month</li>
</ol>
<p><strong>Success Criteria</strong>:</p>
<ul>
<li>80% cost reduction achieved</li>
<li>0% error trace loss</li>
<li>p95 latency still visible</li>
</ul>
<h4 id="3-multi-tenancy-challenge">3. Multi-Tenancy Challenge<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#3-multi-tenancy-challenge" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Goal</strong>: Deploy SaaS platform with 5 tenants, isolated telemetry pipelines</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Deploy OBI (shared)</li>
<li>Deploy Alloy with routing connector (by namespace)</li>
<li>Deploy 5 Tempo instances (per tenant)</li>
<li>Configure Grafana with tenant-specific datasources</li>
</ol>
<p><strong>Success Criteria</strong>:</p>
<ul>
<li>Each tenant sees only their traces</li>
<li>No data leakage between tenants</li>
<li>Single OBI deployment serves all tenants</li>
</ul>
<h4 id="4-adaptive-sampling-challenge">4. Adaptive Sampling Challenge<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#4-adaptive-sampling-challenge" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Goal</strong>: Dynamically adjust sampling based on SLO breaches</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Define SLO: p95 &lt; 1s</li>
<li>Configure Prometheus alert: p95 > 1s for 5 minutes</li>
<li>Webhook triggers sampling increase: 10% → 50%</li>
<li>Auto-revert after 30 minutes</li>
</ol>
<p><strong>Success Criteria</strong>:</p>
<ul>
<li>Automatic response to SLO breach (&lt; 1 minute)</li>
<li>Capture 5x more traces during incident</li>
<li>Cost impact minimized (temporary spike only)</li>
</ul>
<h4 id="5-database-query-profiling-challenge">5. Database Query Profiling Challenge<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#5-database-query-profiling-challenge" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p><strong>Goal</strong>: Identify top 10 slow SQL queries without DB instrumentation</p>
<p><strong>Steps</strong>:</p>
<ol>
<li>Enable SQL instrumentation in OBI</li>
<li>Run production workload for 1 hour</li>
<li>Query Tempo for slow SQL spans (duration > 1s)</li>
<li>Group by query, aggregate p95 latency</li>
<li>Optimize top 3 queries (add indexes, rewrite)</li>
</ol>
<p><strong>Success Criteria</strong>:</p>
<ul>
<li>Top 10 slow queries identified</li>
<li>Zero database instrumentation required</li>
<li>p95 latency improved by 50% after optimization</li>
</ul>
<h3 id="next-steps">Next Steps<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#next-steps" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ol>
<li><strong>Start Small</strong>: Deploy OBI + LGTM stack in dev/staging environment</li>
<li><strong>Validate Telemetry</strong>: Verify traces, metrics, and service graph accuracy</li>
<li><strong>Tune Sampling</strong>: Implement tail-based sampling for cost optimization</li>
<li><strong>Expand Coverage</strong>: Roll out to production incrementally (one service/team at a time)</li>
<li><strong>Train Team</strong>: Provide training on TraceQL, PromQL, and Grafana dashboards</li>
<li><strong>Measure Impact</strong>: Track MTTR, MTTD, and observability cost savings</li>
<li><strong>Iterate</strong>: Continuously improve sampling policies, dashboards, and alerts</li>
</ol>
<hr/>
<h2 id="sources--references">Sources &amp; References<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sources--references" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<h3 id="official-documentation">Official Documentation<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#official-documentation" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>OpenTelemetry OBI</strong>: <a href="https://opentelemetry.io/docs/zero-code/obi/" class="external">https://opentelemetry.io/docs/zero-code/obi/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>OBI First Release</strong>: <a href="https://opentelemetry.io/blog/2025/obi-announcing-first-release/" class="external">https://opentelemetry.io/blog/2025/obi-announcing-first-release/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Grafana Beyla</strong>: <a href="https://grafana.com/oss/beyla-ebpf/" class="external">https://grafana.com/oss/beyla-ebpf/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Grafana Alloy</strong>: <a href="https://grafana.com/docs/alloy/latest/" class="external">https://grafana.com/docs/alloy/latest/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Grafana Tempo</strong>: <a href="https://grafana.com/docs/tempo/latest/" class="external">https://grafana.com/docs/tempo/latest/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Grafana Mimir</strong>: <a href="https://grafana.com/docs/mimir/latest/" class="external">https://grafana.com/docs/mimir/latest/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Grafana Loki</strong>: <a href="https://grafana.com/docs/loki/latest/" class="external">https://grafana.com/docs/loki/latest/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="github-repositories">GitHub Repositories<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#github-repositories" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>OBI</strong>: <a href="https://github.com/open-telemetry/opentelemetry-ebpf-instrumentation" class="external">https://github.com/open-telemetry/opentelemetry-ebpf-instrumentation<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Alloy Operator</strong>: <a href="https://github.com/grafana/alloy-operator" class="external">https://github.com/grafana/alloy-operator<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>OpenTelemetry Helm Charts</strong>: <a href="https://github.com/open-telemetry/opentelemetry-helm-charts" class="external">https://github.com/open-telemetry/opentelemetry-helm-charts<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="blog-posts--articles">Blog Posts &amp; Articles<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#blog-posts--articles" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>Beyla Donation to OpenTelemetry</strong>: <a href="https://grafana.com/blog/2025/05/07/opentelemetry-ebpf-instrumentation-beyla-donation/" class="external">https://grafana.com/blog/2025/05/07/opentelemetry-ebpf-instrumentation-beyla-donation/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Tail Sampling with OpenTelemetry</strong>: <a href="https://opentelemetry.io/blog/2022/tail-sampling/" class="external">https://opentelemetry.io/blog/2022/tail-sampling/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Multi-Tenant Observability</strong>: <a href="https://aaronbytestream.medium.com/multi-tenant-distributed-tracing-withopentelemetry-86e1cf940d2e" class="external">https://aaronbytestream.medium.com/multi-tenant-distributed-tracing-withopentelemetry-86e1cf940d2e<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Alloy Operator Configuration</strong>: <a href="https://grafana.com/blog/2025/06/17/configure-and-customize-kubernetes-monitoring-easier-with-alloy-operator/" class="external">https://grafana.com/blog/2025/06/17/configure-and-customize-kubernetes-monitoring-easier-with-alloy-operator/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
</ul>
<h3 id="community-resources">Community Resources<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#community-resources" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<ul>
<li><strong>OpenTelemetry Community</strong>: <a href="https://opentelemetry.io/community/" class="external">https://opentelemetry.io/community/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>Grafana Labs Community</strong>: <a href="https://community.grafana.com/" class="external">https://community.grafana.com/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a></li>
<li><strong>CNCF Slack</strong>: <a href="https://slack.cncf.io/" class="external">https://slack.cncf.io/<svg aria-hidden="true" class="external-icon" style="max-width:0.8em;max-height:0.8em;" viewBox="0 0 512 512"><path d="M320 0H288V64h32 82.7L201.4 265.4 178.7 288 224 333.3l22.6-22.6L448 109.3V192v32h64V192 32 0H480 320zM32 32H0V64 480v32H32 456h32V480 352 320H424v32 96H64V96h96 32V32H160 32z"></path></svg></a> (#opentelemetry, <a href="../../../.././../../../tags/grafana" class="tag-link internal alias" data-slug="tags/grafana">grafana</a>)</li>
</ul>
<hr/>
<p><strong>Report Prepared By</strong>: Research Agent (Claude Flow)
<strong>Last Updated</strong>: November 6, 2025
<strong>Version</strong>: 1.0</p></article><hr/><div class="page-footer"></div></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div class="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false,&quot;enableRadial&quot;:false}"></div><button class="global-graph-icon" aria-label="Global Graph"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
                s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
                c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
                C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
                c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
                v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
                s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
                C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
                S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
                s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
                s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></button></div><div class="global-graph-outer"><div class="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.2,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true,&quot;enableRadial&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" class="toc-header" aria-controls="toc-178" aria-expanded="true"><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><ul id="list-1" class="toc-content overflow"><li class="depth-0"><a href="#opentelemetry-backend-initiative-obi---comprehensive-research-report" data-for="opentelemetry-backend-initiative-obi---comprehensive-research-report">OpenTelemetry Backend Initiative (OBI) - Comprehensive Research Report</a></li><li class="depth-1"><a href="#table-of-contents" data-for="table-of-contents">Table of Contents</a></li><li class="depth-1"><a href="#executive-summary" data-for="executive-summary">Executive Summary</a></li><li class="depth-1"><a href="#what-is-obi" data-for="what-is-obi">What is OBI?</a></li><li class="depth-2"><a href="#definition" data-for="definition">Definition</a></li><li class="depth-2"><a href="#core-concept" data-for="core-concept">Core Concept</a></li><li class="depth-2"><a href="#origins" data-for="origins">Origins</a></li><li class="depth-1"><a href="#first-release-details" data-for="first-release-details">First Release Details</a></li><li class="depth-2"><a href="#release-information" data-for="release-information">Release Information</a></li><li class="depth-2"><a href="#key-features-in-v10-alpha" data-for="key-features-in-v10-alpha">Key Features in v1.0 Alpha</a></li><li class="depth-2"><a href="#current-limitations" data-for="current-limitations">Current Limitations</a></li><li class="depth-1"><a href="#architecture--technical-design" data-for="architecture--technical-design">Architecture &amp; Technical Design</a></li><li class="depth-2"><a href="#high-level-architecture" data-for="high-level-architecture">High-Level Architecture</a></li><li class="depth-2"><a href="#components" data-for="components">Components</a></li><li class="depth-2"><a href="#how-it-works-http-request-example" data-for="how-it-works-http-request-example">How It Works: HTTP Request Example</a></li><li class="depth-2"><a href="#comparison-traditional-vs-ebpf-instrumentation" data-for="comparison-traditional-vs-ebpf-instrumentation">Comparison: Traditional vs eBPF Instrumentation</a></li><li class="depth-1"><a href="#integration-with-grafana-stack" data-for="integration-with-grafana-stack">Integration with Grafana Stack</a></li><li class="depth-2"><a href="#lgtm-stack-overview" data-for="lgtm-stack-overview">LGTM Stack Overview</a></li><li class="depth-2"><a href="#components-1" data-for="components-1">Components</a></li><li class="depth-2"><a href="#architecture-diagram-obi--lgtm-stack" data-for="architecture-diagram-obi--lgtm-stack">Architecture Diagram: OBI + LGTM Stack</a></li><li class="depth-1"><a href="#deployment-strategies" data-for="deployment-strategies">Deployment Strategies</a></li><li class="depth-2"><a href="#alloy-operator-vs-standalone-deployment" data-for="alloy-operator-vs-standalone-deployment">Alloy Operator vs Standalone Deployment</a></li><li class="depth-2"><a href="#deployment-patterns" data-for="deployment-patterns">Deployment Patterns</a></li><li class="depth-2"><a href="#obi-deployment-pattern" data-for="obi-deployment-pattern">OBI Deployment Pattern</a></li><li class="depth-2"><a href="#decision-matrix-operator-vs-standalone" data-for="decision-matrix-operator-vs-standalone">Decision Matrix: Operator vs Standalone</a></li><li class="depth-1"><a href="#key-use-cases" data-for="key-use-cases">Key Use Cases</a></li><li class="depth-2"><a href="#1-zero-code-instrumentation-for-legacy-applications" data-for="1-zero-code-instrumentation-for-legacy-applications">1. Zero-Code Instrumentation for Legacy Applications</a></li><li class="depth-2"><a href="#2-multi-protocol-service-observability" data-for="2-multi-protocol-service-observability">2. Multi-Protocol Service Observability</a></li><li class="depth-2"><a href="#3-cost-optimization-with-adaptive-sampling" data-for="3-cost-optimization-with-adaptive-sampling">3. Cost Optimization with Adaptive Sampling</a></li><li class="depth-2"><a href="#4-multi-tenancy-with-dynamic-routing" data-for="4-multi-tenancy-with-dynamic-routing">4. Multi-Tenancy with Dynamic Routing</a></li><li class="depth-2"><a href="#5-performance-benchmarking--ab-testing" data-for="5-performance-benchmarking--ab-testing">5. Performance Benchmarking &amp; A/B Testing</a></li><li class="depth-1"><a href="#experimental-implementations" data-for="experimental-implementations">Experimental Implementations</a></li><li class="depth-2"><a href="#experiment-1-adaptive-tail-based-sampling-with-slo-integration" data-for="experiment-1-adaptive-tail-based-sampling-with-slo-integration">Experiment 1: Adaptive Tail-Based Sampling with SLO Integration</a></li><li class="depth-2"><a href="#experiment-2-network-level-service-dependency-discovery" data-for="experiment-2-network-level-service-dependency-discovery">Experiment 2: Network-Level Service Dependency Discovery</a></li><li class="depth-2"><a href="#experiment-3-database-query-performance-profiling" data-for="experiment-3-database-query-performance-profiling">Experiment 3: Database Query Performance Profiling</a></li><li class="depth-2"><a href="#experiment-4-cost-optimized-multi-region-observability" data-for="experiment-4-cost-optimized-multi-region-observability">Experiment 4: Cost-Optimized Multi-Region Observability</a></li><li class="depth-2"><a href="#experiment-5-canary-deployment-automated-rollback" data-for="experiment-5-canary-deployment-automated-rollback">Experiment 5: Canary Deployment Automated Rollback</a></li><li class="depth-1"><a href="#helm-charts--kubernetes" data-for="helm-charts--kubernetes">Helm Charts &amp; Kubernetes</a></li><li class="depth-2"><a href="#official-helm-charts" data-for="official-helm-charts">Official Helm Charts</a></li><li class="depth-2"><a href="#complete-obi--lgtm-deployment" data-for="complete-obi--lgtm-deployment">Complete OBI + LGTM Deployment</a></li><li class="depth-1"><a href="#comparison-with-traditional-backends" data-for="comparison-with-traditional-backends">Comparison with Traditional Backends</a></li><li class="depth-2"><a href="#traditional-apm-approach" data-for="traditional-apm-approach">Traditional APM Approach</a></li><li class="depth-2"><a href="#obi-approach" data-for="obi-approach">OBI Approach</a></li><li class="depth-2"><a href="#detailed-comparison-table" data-for="detailed-comparison-table">Detailed Comparison Table</a></li><li class="depth-2"><a href="#when-to-use-each-approach" data-for="when-to-use-each-approach">When to Use Each Approach</a></li><li class="depth-1"><a href="#recommendations" data-for="recommendations">Recommendations</a></li><li class="depth-2"><a href="#quick-start-path" data-for="quick-start-path">Quick Start Path</a></li><li class="depth-2"><a href="#production-readiness-checklist" data-for="production-readiness-checklist">Production Readiness Checklist</a></li><li class="depth-2"><a href="#interesting-experiments-to-try" data-for="interesting-experiments-to-try">Interesting Experiments to Try</a></li><li class="depth-2"><a href="#next-steps" data-for="next-steps">Next Steps</a></li><li class="depth-1"><a href="#sources--references" data-for="sources--references">Sources &amp; References</a></li><li class="depth-2"><a href="#official-documentation" data-for="official-documentation">Official Documentation</a></li><li class="depth-2"><a href="#github-repositories" data-for="github-repositories">GitHub Repositories</a></li><li class="depth-2"><a href="#blog-posts--articles" data-for="blog-posts--articles">Blog Posts &amp; Articles</a></li><li class="depth-2"><a href="#community-resources" data-for="community-resources">Community Resources</a></li><li class="overflow-end"></li></ul></div></div><footer class><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.5.2</a> © 2025</p><ul><li><a href="https://github.com/raibid-labs">Raibid Labs</a></li><li><a href="https://github.com/raibid-labs/docs">Documentation Hub</a></li></ul></footer></div></div></body><script type="application/javascript">function n(){let t=this.parentElement;t.classList.toggle("is-collapsed");let e=t.getElementsByClassName("callout-content")[0];if(!e)return;let l=t.classList.contains("is-collapsed");e.style.gridTemplateRows=l?"0fr":"1fr"}function c(){let t=document.getElementsByClassName("callout is-collapsible");for(let e of t){let l=e.getElementsByClassName("callout-title")[0],s=e.getElementsByClassName("callout-content")[0];if(!l||!s)continue;l.addEventListener("click",n),window.addCleanup(()=>l.removeEventListener("click",n));let o=e.classList.contains("is-collapsed");s.style.gridTemplateRows=o?"0fr":"1fr"}}document.addEventListener("nav",c);
</script><script type="module">function f(i,e){if(!i)return;function r(o){o.target===this&&(o.preventDefault(),o.stopPropagation(),e())}function t(o){o.key.startsWith("Esc")&&(o.preventDefault(),e())}i?.addEventListener("click",r),window.addCleanup(()=>i?.removeEventListener("click",r)),document.addEventListener("keydown",t),window.addCleanup(()=>document.removeEventListener("keydown",t))}function y(i){for(;i.firstChild;)i.removeChild(i.firstChild)}var h=class{constructor(e,r){this.container=e;this.content=r;this.setupEventListeners(),this.setupNavigationControls(),this.resetTransform()}isDragging=!1;startPan={x:0,y:0};currentPan={x:0,y:0};scale=1;MIN_SCALE=.5;MAX_SCALE=3;cleanups=[];setupEventListeners(){let e=this.onMouseDown.bind(this),r=this.onMouseMove.bind(this),t=this.onMouseUp.bind(this),o=this.resetTransform.bind(this);this.container.addEventListener("mousedown",e),document.addEventListener("mousemove",r),document.addEventListener("mouseup",t),window.addEventListener("resize",o),this.cleanups.push(()=>this.container.removeEventListener("mousedown",e),()=>document.removeEventListener("mousemove",r),()=>document.removeEventListener("mouseup",t),()=>window.removeEventListener("resize",o))}cleanup(){for(let e of this.cleanups)e()}setupNavigationControls(){let e=document.createElement("div");e.className="mermaid-controls";let r=this.createButton("+",()=>this.zoom(.1)),t=this.createButton("-",()=>this.zoom(-.1)),o=this.createButton("Reset",()=>this.resetTransform());e.appendChild(t),e.appendChild(o),e.appendChild(r),this.container.appendChild(e)}createButton(e,r){let t=document.createElement("button");return t.textContent=e,t.className="mermaid-control-button",t.addEventListener("click",r),window.addCleanup(()=>t.removeEventListener("click",r)),t}onMouseDown(e){e.button===0&&(this.isDragging=!0,this.startPan={x:e.clientX-this.currentPan.x,y:e.clientY-this.currentPan.y},this.container.style.cursor="grabbing")}onMouseMove(e){this.isDragging&&(e.preventDefault(),this.currentPan={x:e.clientX-this.startPan.x,y:e.clientY-this.startPan.y},this.updateTransform())}onMouseUp(){this.isDragging=!1,this.container.style.cursor="grab"}zoom(e){let r=Math.min(Math.max(this.scale+e,this.MIN_SCALE),this.MAX_SCALE),t=this.content.getBoundingClientRect(),o=t.width/2,n=t.height/2,c=r-this.scale;this.currentPan.x-=o*c,this.currentPan.y-=n*c,this.scale=r,this.updateTransform()}updateTransform(){this.content.style.transform=`translate(${this.currentPan.x}px, ${this.currentPan.y}px) scale(${this.scale})`}resetTransform(){this.scale=1;let e=this.content.querySelector("svg");this.currentPan={x:e.getBoundingClientRect().width/2,y:e.getBoundingClientRect().height/2},this.updateTransform()}},C=["--secondary","--tertiary","--gray","--light","--lightgray","--highlight","--dark","--darkgray","--codeFont"],E;document.addEventListener("nav",async()=>{let e=document.querySelector(".center").querySelectorAll("code.mermaid");if(e.length===0)return;E||=await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/11.4.0/mermaid.esm.min.mjs");let r=E.default,t=new WeakMap;for(let n of e)t.set(n,n.innerText);async function o(){for(let s of e){s.removeAttribute("data-processed");let a=t.get(s);a&&(s.innerHTML=a)}let n=C.reduce((s,a)=>(s[a]=window.getComputedStyle(document.documentElement).getPropertyValue(a),s),{}),c=document.documentElement.getAttribute("saved-theme")==="dark";r.initialize({startOnLoad:!1,securityLevel:"loose",theme:c?"dark":"base",themeVariables:{fontFamily:n["--codeFont"],primaryColor:n["--light"],primaryTextColor:n["--darkgray"],primaryBorderColor:n["--tertiary"],lineColor:n["--darkgray"],secondaryColor:n["--secondary"],tertiaryColor:n["--tertiary"],clusterBkg:n["--light"],edgeLabelBackground:n["--highlight"]}}),await r.run({nodes:e})}await o(),document.addEventListener("themechange",o),window.addCleanup(()=>document.removeEventListener("themechange",o));for(let n=0;n<e.length;n++){let v=function(){let g=l.querySelector("#mermaid-space"),m=l.querySelector(".mermaid-content");if(!m)return;y(m);let w=c.querySelector("svg").cloneNode(!0);m.appendChild(w),l.classList.add("active"),g.style.cursor="grab",u=new h(g,m)},M=function(){l.classList.remove("active"),u?.cleanup(),u=null},c=e[n],s=c.parentElement,a=s.querySelector(".clipboard-button"),d=s.querySelector(".expand-button"),p=window.getComputedStyle(a),L=a.offsetWidth+parseFloat(p.marginLeft||"0")+parseFloat(p.marginRight||"0");d.style.right=`calc(${L}px + 0.3rem)`,s.prepend(d);let l=s.querySelector("#mermaid-container");if(!l)return;let u=null;d.addEventListener("click",v),f(l,M),window.addCleanup(()=>{u?.cleanup(),d.removeEventListener("click",v)})}});
</script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script src="../../../../postscript.js" type="module"></script></html>